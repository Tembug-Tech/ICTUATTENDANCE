{"ast":null,"code":"import _objectSpread from\"C:/Users/PFI/Desktop/ATTENDANCE/ATTENDANCE/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{supabase}from'../supabase/supabase';import{useAuth}from'../contexts/AuthContext';import Layout from'../components/Layout';import Modal from'../components/Modal';import Alert from'../components/Alert';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const DelegateDashboard=()=>{var _selectedAttendanceFo,_selectedAttendanceFo2,_selectedAttendanceFo3,_selectedAttendanceFo4,_selectedAttendanceFo5,_selectedAttendanceFo6,_selectedAttendanceFo7;const{currentUser,userRole,loading}=useAuth();const navigate=useNavigate();// State\nconst[activeTab,setActiveTab]=useState('overview');const[sessions,setSessions]=useState([]);const[courses,setCourses]=useState([]);const[attendanceHistory,setAttendanceHistory]=useState([]);const[attendanceStats,setAttendanceStats]=useState({totalAttendance:0,uniqueStudents:0,thisMonth:0,lastMonth:0});const[stats,setStats]=useState({activeSessions:0,totalSessions:0,totalMarked:0,todaySessions:0});// Modal state\nconst[showCreateSessionModal,setShowCreateSessionModal]=useState(false);const[showAttendanceModal,setShowAttendanceModal]=useState(false);const[showNotesModal,setShowNotesModal]=useState(false);const[selectedSessionForAttendance,setSelectedSessionForAttendance]=useState(null);const[selectedAttendanceForNotes,setSelectedAttendanceForNotes]=useState(null);const[attendanceList,setAttendanceList]=useState([]);const[noteText,setNoteText]=useState('');// Form state\nconst[createSessionForm,setCreateSessionForm]=useState({courseId:'',date:new Date().toISOString().split('T')[0],startTime:'08:00',endTime:'10:00'});// UI state\nconst[loading2,setLoading2]=useState(true);const[error,setError]=useState(null);const[success,setSuccess]=useState(null);const[isCreating,setIsCreating]=useState(false);const[isClosing,setIsClosing]=useState(false);const[isMarking,setIsMarking]=useState(false);const[timeCountdown,setTimeCountdown]=useState({});useEffect(()=>{if(loading)return;if(!currentUser||userRole!=='delegate'){navigate('/delegate');return;}fetchAllData();},[currentUser,userRole,loading,navigate]);// Timer for countdown\nuseEffect(()=>{const interval=setInterval(()=>{setTimeCountdown(prev=>{const updated=_objectSpread({},prev);Object.keys(updated).forEach(sessionId=>{const session=sessions.find(s=>s.id===sessionId);if(session){const now=new Date();const[endHour,endMin]=session.end_time.split(':');const sessionDate=new Date(session.session_date);const endTime=new Date(sessionDate);endTime.setHours(parseInt(endHour),parseInt(endMin),0);const diffMs=endTime-now;if(diffMs<=0){delete updated[sessionId];}else{const minutes=Math.floor(diffMs/60000);const seconds=Math.floor(diffMs%60000/1000);updated[sessionId]=\"\".concat(minutes,\"m \").concat(seconds,\"s\");}}});return updated;});},1000);return()=>clearInterval(interval);},[sessions]);const fetchAllData=async()=>{try{setLoading2(true);setError(null);// Fetch courses\nconst{data:coursesData}=await supabase.from('courses').select('id, course_code, course_title').order('course_code',{ascending:true});setCourses(coursesData||[]);// Fetch sessions\nconst{data:sessionsData}=await supabase.from('sessions').select(\"\\n          id,\\n          session_date,\\n          start_time,\\n          end_time,\\n          created_at,\\n          expires_at,\\n          classes (\\n            class_name\\n          )\\n        \").order('created_at',{ascending:false});// Get attendance counts\nconst sessionsWithCounts=await Promise.all((sessionsData||[]).map(async session=>{const{data:attendanceData}=await supabase.from('attendance').select('id').eq('session_id',session.id);const isActive=new Date(session.expires_at)>new Date();return _objectSpread(_objectSpread({},session),{},{attendanceCount:(attendanceData===null||attendanceData===void 0?void 0:attendanceData.length)||0,isActive});}));setSessions(sessionsWithCounts);// Fetch attendance history from all delegate's sessions\nconst{data:allAttendance}=await supabase.from('attendance').select(\"\\n          id,\\n          session_id,\\n          student_id,\\n          notes,\\n          created_at,\\n          users (\\n            name,\\n            matricule,\\n            email\\n          ),\\n          sessions (\\n            session_date,\\n            start_time,\\n            end_time,\\n            classes (\\n              class_name\\n            )\\n          )\\n        \").order('created_at',{ascending:false});setAttendanceHistory(allAttendance||[]);// Calculate attendance stats\nif(allAttendance&&allAttendance.length>0){const uniqueStudents=new Set(allAttendance.map(a=>a.student_id)).size;const now=new Date();const thisMonth=allAttendance.filter(a=>{const date=new Date(a.created_at);return date.getMonth()===now.getMonth()&&date.getFullYear()===now.getFullYear();}).length;const lastMonth=allAttendance.filter(a=>{const date=new Date(a.created_at);const prevMonth=now.getMonth()===0?11:now.getMonth()-1;const prevYear=now.getMonth()===0?now.getFullYear()-1:now.getFullYear();return date.getMonth()===prevMonth&&date.getFullYear()===prevYear;}).length;setAttendanceStats({totalAttendance:allAttendance.length,uniqueStudents,thisMonth,lastMonth});}// Calculate stats\nconst activeSessions=sessionsWithCounts.filter(s=>s.isActive).length;const totalMarked=sessionsWithCounts.reduce((sum,s)=>sum+s.attendanceCount,0);const todaySessions=sessionsWithCounts.filter(s=>s.session_date===new Date().toISOString().split('T')[0]).length;setStats({activeSessions,totalSessions:sessionsWithCounts.length,totalMarked,todaySessions});}catch(err){console.error('Error fetching data:',err);setError('Failed to load dashboard data');}finally{setLoading2(false);}};const handleCreateSession=async()=>{if(!createSessionForm.courseId){setError('Please select a course');return;}if(!createSessionForm.startTime||!createSessionForm.endTime){setError('Please set start and end times');return;}if(createSessionForm.startTime>=createSessionForm.endTime){setError('End time must be after start time');return;}try{setIsCreating(true);setError(null);const selectedCourse=courses.find(c=>c.id===createSessionForm.courseId);if(!selectedCourse){setError('Selected course not found');return;}// Check or create class\nconst{data:existingClass}=await supabase.from('classes').select('id').eq('course_id',selectedCourse.id).eq('delegate_id',currentUser.id);let classId=existingClass&&existingClass.length>0?existingClass[0].id:null;if(!classId){const{data:newClass,error:classError}=await supabase.from('classes').insert({class_name:\"\".concat(selectedCourse.course_code,\" - \").concat(selectedCourse.course_title),course_id:selectedCourse.id,delegate_id:currentUser.id}).select('id').single();if(classError)throw classError;classId=newClass.id;}// Create session\nconst sessionDate=new Date(createSessionForm.date);const[startHour,startMin]=createSessionForm.startTime.split(':');const[endHour,endMin]=createSessionForm.endTime.split(':');const endDateTime=new Date(sessionDate);endDateTime.setHours(parseInt(endHour),parseInt(endMin),59,999);const{error:sessionError}=await supabase.from('sessions').insert({class_id:classId,token:\"SESSION_\".concat(Date.now()),session_date:createSessionForm.date,start_time:createSessionForm.startTime,end_time:createSessionForm.endTime,expires_at:endDateTime.toISOString()});if(sessionError)throw sessionError;setSuccess('âœ… Attendance session created successfully!');setShowCreateSessionModal(false);setCreateSessionForm({courseId:'',date:new Date().toISOString().split('T')[0],startTime:'08:00',endTime:'10:00'});await fetchAllData();setTimeout(()=>setSuccess(null),3000);}catch(err){console.error('Error creating session:',err);setError(\"Error: \".concat(err.message));}finally{setIsCreating(false);}};const handleCloseSession=async sessionId=>{if(!window.confirm('Close this session? Students will no longer be able to mark attendance.'))return;try{setIsClosing(true);setError(null);const{error}=await supabase.from('sessions').update({expires_at:new Date().toISOString()}).eq('id',sessionId);if(error)throw error;setSuccess('âœ… Session closed successfully!');await fetchAllData();setTimeout(()=>setSuccess(null),3000);}catch(err){console.error('Error closing session:',err);setError(\"Error: \".concat(err.message));}finally{setIsClosing(false);}};const handleMarkOwnAttendance=async sessionId=>{try{setIsMarking(true);setError(null);// Check if already marked\nconst{data:existing}=await supabase.from('attendance').select('id').eq('session_id',sessionId).eq('student_id',currentUser.id);if(existing&&existing.length>0){setError('You have already marked attendance for this session');return;}// Mark attendance\nconst{error}=await supabase.from('attendance').insert({session_id:sessionId,student_id:currentUser.id,created_at:new Date().toISOString()});if(error)throw error;setSuccess('âœ… Your attendance has been marked!');await fetchAllData();setTimeout(()=>setSuccess(null),3000);}catch(err){console.error('Error marking attendance:',err);setError(\"Error: \".concat(err.message));}finally{setIsMarking(false);}};const handleViewAttendance=async sessionId=>{try{setError(null);const{data,error}=await supabase.from('attendance').select(\"\\n          id,\\n          created_at,\\n          users (\\n            name,\\n            matricule\\n          )\\n        \").eq('session_id',sessionId).order('created_at',{ascending:false});if(error)throw error;setSelectedSessionForAttendance(sessionId);setAttendanceList(data||[]);setShowAttendanceModal(true);}catch(err){console.error('Error fetching attendance:',err);setError(\"Error: \".concat(err.message));}};if(loading||loading2){return/*#__PURE__*/_jsx(Layout,{role:\"delegate\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-screen bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-block animate-spin rounded-full h-12 w-12 border border-gray-300 border-t-blue-900 mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Loading...\"})]})})});}if(!currentUser||userRole!=='delegate')return null;const activeSessions=sessions.filter(s=>s.isActive);return/*#__PURE__*/_jsx(Layout,{role:\"delegate\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-6 sm:px-8 py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-semibold text-gray-900\",children:\"Delegate Dashboard\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2\",children:\"Manage attendance sessions and monitor student attendance\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg w-fit\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xl mr-2\",children:\"\\uD83D\\uDC64\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-semibold text-blue-900\",children:\"Delegate\"})]})]})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800 text-sm\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg text-green-800 text-sm\",children:success}),activeTab==='overview'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12\",children:[{label:'Active Sessions',value:stats.activeSessions,icon:'ðŸ”´',bgClass:'bg-blue-50',borderClass:'border-blue-200',textClass:'text-blue-900'},{label:'Total Sessions',value:stats.totalSessions,icon:'ðŸ“‹',bgClass:'bg-green-50',borderClass:'border-green-200',textClass:'text-green-900'},{label:'Total Marked',value:stats.totalMarked,icon:'âœ“',bgClass:'bg-amber-50',borderClass:'border-amber-200',textClass:'text-amber-900'},{label:\"Today's Sessions\",value:stats.todaySessions,icon:'ðŸ“…',bgClass:'bg-purple-50',borderClass:'border-purple-200',textClass:'text-purple-900'}].map((stat,idx)=>/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(stat.bgClass,\" border \").concat(stat.borderClass,\" rounded-lg p-6 transition-shadow hover:shadow-md\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-gray-600 uppercase tracking-wide mb-3\",children:stat.label}),/*#__PURE__*/_jsx(\"p\",{className:\"text-4xl font-bold \".concat(stat.textClass),children:stat.value})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-3xl opacity-50\",children:stat.icon})]})},idx))}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-12\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-900 mb-6\",children:\"Quick Actions\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[{label:'Create Session',icon:'âž•',action:()=>{setActiveTab('sessions');setShowCreateSessionModal(true);},description:'Start a new attendance session'},{label:'View Active Sessions',icon:'ðŸ‘ï¸',action:()=>setActiveTab('sessions'),description:'See all your active sessions'}].map((action,idx)=>/*#__PURE__*/_jsx(\"button\",{onClick:action.action,className:\"bg-white border border-gray-200 rounded-lg p-6 text-left hover:shadow-md hover:border-blue-300 transition-all group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl\",children:action.icon}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-base font-semibold text-gray-900 group-hover:text-blue-900 transition-colors\",children:action.label}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:action.description})]})]})},idx))})]}),activeSessions.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white border border-gray-200 rounded-lg p-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 mb-6\",children:\"Active Right Now\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:activeSessions.slice(0,3).map(session=>{var _session$classes;return/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border border-gray-200 rounded-lg hover:border-blue-300 hover:shadow-sm transition-all\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-base font-semibold text-gray-900\",children:(_session$classes=session.classes)===null||_session$classes===void 0?void 0:_session$classes.class_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4 mt-2 text-sm text-gray-600\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uD83D\\uDCC5 \",session.session_date]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uD83D\\uDD50 \",session.start_time,\" - \",session.end_time]})]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-semibold\",children:\"\\u25CF ACTIVE\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center pt-4 border-t border-gray-100\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-900\",children:session.attendanceCount}),\" students marked\"]}),timeCountdown[session.id]&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium text-blue-900\",children:[\"\\u23F1 \",timeCountdown[session.id]]})]})]},session.id);})})]}),activeSessions.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white border border-gray-200 rounded-lg p-12 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-lg\",children:\"No active sessions right now\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400 text-sm mt-2\",children:\"Create a new session to get started\"})]})]}),activeTab==='sessions'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold text-gray-900\",children:\"Sessions\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 text-sm mt-2\",children:[sessions.length,\" total sessions\"]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowCreateSessionModal(true),className:\"px-6 py-3 bg-blue-900 text-white rounded-lg text-sm font-semibold hover:bg-blue-800 transition-colors inline-flex items-center gap-2 w-fit\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2795\"}),\" Create Session\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border border-gray-200 rounded-lg overflow-hidden\",children:sessions.length>0?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-gray-50 border-b border-gray-200\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Course\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Time\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Marked\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:sessions.map(session=>{var _session$classes2;return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50 transition-colors\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm font-medium text-gray-900\",children:(_session$classes2=session.classes)===null||_session$classes2===void 0?void 0:_session$classes2.class_name}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm text-gray-600\",children:session.session_date}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-6 py-4 text-sm text-gray-600\",children:[session.start_time,\" - \",session.end_time]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm font-semibold text-gray-900\",children:session.attendanceCount}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 rounded-full text-xs font-semibold \".concat(session.isActive?'bg-green-100 text-green-800':'bg-gray-100 text-gray-600'),children:session.isActive?'â— ACTIVE':'â—‹ CLOSED'})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 justify-center\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleViewAttendance(session.id),className:\"px-3 py-1.5 bg-blue-100 text-blue-700 rounded text-xs font-semibold hover:bg-blue-200 transition-colors\",children:\"View\"}),session.isActive&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleMarkOwnAttendance(session.id),disabled:isMarking,className:\"px-3 py-1.5 bg-green-100 text-green-700 rounded text-xs font-semibold hover:bg-green-200 transition-colors disabled:opacity-50\",children:\"Mark\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleCloseSession(session.id),disabled:isClosing,className:\"px-3 py-1.5 bg-red-100 text-red-700 rounded text-xs font-semibold hover:bg-red-200 transition-colors disabled:opacity-50\",children:\"Close\"})]})]})})]},session.id);})})]})})}):/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-16 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-lg\",children:\"No sessions created yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400 text-sm mt-2\",children:\"Create your first session to get started\"})]})})]}),activeTab==='attendance-history'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold text-gray-900\",children:\"Attendance History\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm mt-2\",children:\"Complete record of all attendance marked across your sessions\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12\",children:[{label:'Total Attendance Records',value:attendanceStats.totalAttendance,icon:'ðŸ“Š',bgClass:'bg-blue-50',borderClass:'border-blue-200',textClass:'text-blue-900'},{label:'Unique Students',value:attendanceStats.uniqueStudents,icon:'ðŸ‘¥',bgClass:'bg-green-50',borderClass:'border-green-200',textClass:'text-green-900'},{label:'This Month',value:attendanceStats.thisMonth,icon:'ðŸ“…',bgClass:'bg-amber-50',borderClass:'border-amber-200',textClass:'text-amber-900'},{label:'Last Month',value:attendanceStats.lastMonth,icon:'ðŸ“ˆ',bgClass:'bg-purple-50',borderClass:'border-purple-200',textClass:'text-purple-900'}].map((stat,idx)=>/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(stat.bgClass,\" border \").concat(stat.borderClass,\" rounded-lg p-6 transition-shadow hover:shadow-md\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-gray-600 uppercase tracking-wide mb-3\",children:stat.label}),/*#__PURE__*/_jsx(\"p\",{className:\"text-4xl font-bold \".concat(stat.textClass),children:stat.value})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-3xl opacity-50\",children:stat.icon})]})},idx))}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border border-gray-200 rounded-lg overflow-hidden\",children:attendanceHistory.length>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 flex justify-between items-center border-b border-gray-200 bg-gray-50\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:[\"Attendance Records (\",attendanceHistory.length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{// Export to CSV\nconst csv=[['Name','Matricule','Email','Course','Date','Time Marked','Notes'],...attendanceHistory.map(record=>{var _record$users,_record$users2,_record$users3,_record$sessions,_record$sessions$clas,_record$sessions2;return[((_record$users=record.users)===null||_record$users===void 0?void 0:_record$users.name)||'Unknown',((_record$users2=record.users)===null||_record$users2===void 0?void 0:_record$users2.matricule)||'N/A',((_record$users3=record.users)===null||_record$users3===void 0?void 0:_record$users3.email)||'N/A',((_record$sessions=record.sessions)===null||_record$sessions===void 0?void 0:(_record$sessions$clas=_record$sessions.classes)===null||_record$sessions$clas===void 0?void 0:_record$sessions$clas.class_name)||'N/A',((_record$sessions2=record.sessions)===null||_record$sessions2===void 0?void 0:_record$sessions2.session_date)||'N/A',new Date(record.created_at).toLocaleString(),record.notes||''];})].map(row=>row.map(cell=>\"\\\"\".concat(String(cell).replace(/\"/g,'\"\"'),\"\\\"\")).join(',')).join('\\n');const blob=new Blob([csv],{type:'text/csv'});const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=\"attendance-history-\".concat(new Date().toISOString().split('T')[0],\".csv\");a.click();},className:\"px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-semibold hover:bg-green-700 transition-colors inline-flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDCE5\"}),\" Export CSV\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-gray-50 border-b border-gray-200\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Matricule\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Course\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Time Marked\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-4 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:attendanceHistory.map(record=>{var _record$users4,_record$users5,_record$users6,_record$sessions3,_record$sessions3$cla,_record$sessions4;return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50 transition-colors\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm font-medium text-gray-900\",children:((_record$users4=record.users)===null||_record$users4===void 0?void 0:_record$users4.name)||'Unknown'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm font-mono text-gray-600\",children:((_record$users5=record.users)===null||_record$users5===void 0?void 0:_record$users5.matricule)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm text-gray-600\",children:((_record$users6=record.users)===null||_record$users6===void 0?void 0:_record$users6.email)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm text-gray-600\",children:((_record$sessions3=record.sessions)===null||_record$sessions3===void 0?void 0:(_record$sessions3$cla=_record$sessions3.classes)===null||_record$sessions3$cla===void 0?void 0:_record$sessions3$cla.class_name)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm text-gray-600\",children:((_record$sessions4=record.sessions)===null||_record$sessions4===void 0?void 0:_record$sessions4.session_date)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-sm text-gray-600\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDD50\"}),new Date(record.created_at).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit',second:'2-digit'})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 justify-center\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setSelectedAttendanceForNotes(record);setNoteText(record.notes||'');setShowNotesModal(true);},className:\"px-3 py-1.5 bg-blue-100 text-blue-700 rounded text-xs font-semibold hover:bg-blue-200 transition-colors\",children:[record.notes?'ðŸ“ View':'âœŽ Add',\" Note\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{var _record$users7,_record$users8,_record$sessions5,_record$sessions6,_record$sessions6$cla,_record$users9;const subject=\"Attendance Confirmation - \".concat((_record$users7=record.users)===null||_record$users7===void 0?void 0:_record$users7.name);const body=\"Dear \".concat((_record$users8=record.users)===null||_record$users8===void 0?void 0:_record$users8.name,\",\\n\\nYour attendance has been recorded on \").concat((_record$sessions5=record.sessions)===null||_record$sessions5===void 0?void 0:_record$sessions5.session_date,\" at \").concat(new Date(record.created_at).toLocaleTimeString(),\" for \").concat((_record$sessions6=record.sessions)===null||_record$sessions6===void 0?void 0:(_record$sessions6$cla=_record$sessions6.classes)===null||_record$sessions6$cla===void 0?void 0:_record$sessions6$cla.class_name,\".\\n\\nBest regards\");window.open(\"mailto:\".concat((_record$users9=record.users)===null||_record$users9===void 0?void 0:_record$users9.email,\"?subject=\").concat(encodeURIComponent(subject),\"&body=\").concat(encodeURIComponent(body)),'_blank');},className:\"px-3 py-1.5 bg-purple-100 text-purple-700 rounded text-xs font-semibold hover:bg-purple-200 transition-colors\",children:\"\\uD83D\\uDCE7 Email\"})]})})]},record.id);})})]})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-16 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-lg\",children:\"No attendance records yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400 text-sm mt-2\",children:\"Attendance records will appear here as students mark attendance in sessions\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-8 mt-12 border-t border-gray-200 pt-6\",children:[{id:'overview',label:'Overview'},{id:'sessions',label:'Sessions'},{id:'attendance-history',label:'Attendance History'}].map(tab=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab(tab.id),className:\"px-4 py-2 text-sm font-semibold transition-colors \".concat(activeTab===tab.id?'text-blue-900 border-b-2 border-blue-900':'text-gray-600 hover:text-gray-900'),children:tab.label},tab.id))})]}),/*#__PURE__*/_jsx(Modal,{isOpen:showCreateSessionModal,title:\"Create Attendance Session\",onClose:()=>setShowCreateSessionModal(false),size:\"md\",footer:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCreateSessionModal(false),className:\"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCreateSession,disabled:isCreating,className:\"px-4 py-2 bg-blue-900 text-white rounded-lg text-sm font-medium hover:bg-blue-800 disabled:opacity-50\",children:isCreating?'Creating...':'Create Session'})]}),children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-900 mb-2\",children:\"Course *\"}),/*#__PURE__*/_jsxs(\"select\",{value:createSessionForm.courseId,onChange:e=>setCreateSessionForm(prev=>_objectSpread(_objectSpread({},prev),{},{courseId:e.target.value})),className:\"w-full px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-900\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select a course\"}),courses.map(course=>/*#__PURE__*/_jsxs(\"option\",{value:course.id,children:[course.course_code,\" - \",course.course_title]},course.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-900 mb-2\",children:\"Date *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:createSessionForm.date,onChange:e=>setCreateSessionForm(prev=>_objectSpread(_objectSpread({},prev),{},{date:e.target.value})),className:\"w-full px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-900\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-900 mb-2\",children:\"Start Time *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:createSessionForm.startTime,onChange:e=>setCreateSessionForm(prev=>_objectSpread(_objectSpread({},prev),{},{startTime:e.target.value})),className:\"w-full px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-900\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-900 mb-2\",children:\"End Time *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:createSessionForm.endTime,onChange:e=>setCreateSessionForm(prev=>_objectSpread(_objectSpread({},prev),{},{endTime:e.target.value})),className:\"w-full px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-900\"})]})]})]})}),/*#__PURE__*/_jsx(Modal,{isOpen:showAttendanceModal,title:\"Attendance Records\",onClose:()=>{setShowAttendanceModal(false);setSelectedSessionForAttendance(null);setAttendanceList([]);},size:\"lg\",footer:/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowAttendanceModal(false);setSelectedSessionForAttendance(null);setAttendanceList([]);},className:\"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\",children:\"Close\"}),children:/*#__PURE__*/_jsx(\"div\",{children:attendanceList.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full text-sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-gray-50 border-b border-gray-200\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left font-semibold text-gray-700 uppercase text-xs tracking-wider\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left font-semibold text-gray-700 uppercase text-xs tracking-wider\",children:\"Matricule\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left font-semibold text-gray-700 uppercase text-xs tracking-wider\",children:\"Time Marked\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:attendanceList.map(record=>{var _record$users0,_record$users1;return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 font-medium text-gray-900\",children:((_record$users0=record.users)===null||_record$users0===void 0?void 0:_record$users0.name)||'Unknown'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-gray-600 font-mono text-sm\",children:((_record$users1=record.users)===null||_record$users1===void 0?void 0:_record$users1.matricule)||'N/A'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-gray-600\",children:new Date(record.created_at).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})})]},record.id);})})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"py-8 text-center text-gray-600\",children:\"No attendance records yet\"})})}),/*#__PURE__*/_jsx(Modal,{isOpen:showNotesModal,title:\"Notes - \".concat(selectedAttendanceForNotes===null||selectedAttendanceForNotes===void 0?void 0:(_selectedAttendanceFo=selectedAttendanceForNotes.users)===null||_selectedAttendanceFo===void 0?void 0:_selectedAttendanceFo.name),onClose:()=>{setShowNotesModal(false);setSelectedAttendanceForNotes(null);setNoteText('');},size:\"md\",footer:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowNotesModal(false);setSelectedAttendanceForNotes(null);setNoteText('');},className:\"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{if(!selectedAttendanceForNotes)return;try{const{error}=await supabase.from('attendance').update({notes:noteText}).eq('id',selectedAttendanceForNotes.id);if(error)throw error;setSuccess('âœ… Note saved successfully!');await fetchAllData();setShowNotesModal(false);setSelectedAttendanceForNotes(null);setNoteText('');setTimeout(()=>setSuccess(null),3000);}catch(err){console.error('Error saving note:',err);setError(\"Error: \".concat(err.message));}},className:\"px-4 py-2 bg-blue-900 text-white rounded-lg text-sm font-medium hover:bg-blue-800\",children:\"Save Note\"})]}),children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-900 mb-2\",children:\"Student Info\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg space-y-2\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-700\",children:\"Name:\"}),\" \",selectedAttendanceForNotes===null||selectedAttendanceForNotes===void 0?void 0:(_selectedAttendanceFo2=selectedAttendanceForNotes.users)===null||_selectedAttendanceFo2===void 0?void 0:_selectedAttendanceFo2.name]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-700\",children:\"Matricule:\"}),\" \",selectedAttendanceForNotes===null||selectedAttendanceForNotes===void 0?void 0:(_selectedAttendanceFo3=selectedAttendanceForNotes.users)===null||_selectedAttendanceFo3===void 0?void 0:_selectedAttendanceFo3.matricule]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-700\",children:\"Email:\"}),\" \",selectedAttendanceForNotes===null||selectedAttendanceForNotes===void 0?void 0:(_selectedAttendanceFo4=selectedAttendanceForNotes.users)===null||_selectedAttendanceFo4===void 0?void 0:_selectedAttendanceFo4.email]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-700\",children:\"Course:\"}),\" \",selectedAttendanceForNotes===null||selectedAttendanceForNotes===void 0?void 0:(_selectedAttendanceFo5=selectedAttendanceForNotes.sessions)===null||_selectedAttendanceFo5===void 0?void 0:(_selectedAttendanceFo6=_selectedAttendanceFo5.classes)===null||_selectedAttendanceFo6===void 0?void 0:_selectedAttendanceFo6.class_name]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-700\",children:\"Date:\"}),\" \",selectedAttendanceForNotes===null||selectedAttendanceForNotes===void 0?void 0:(_selectedAttendanceFo7=selectedAttendanceForNotes.sessions)===null||_selectedAttendanceFo7===void 0?void 0:_selectedAttendanceFo7.session_date]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-700\",children:\"Time Marked:\"}),\" \",(selectedAttendanceForNotes===null||selectedAttendanceForNotes===void 0?void 0:selectedAttendanceForNotes.created_at)&&new Date(selectedAttendanceForNotes.created_at).toLocaleString()]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold text-gray-900 mb-2\",children:\"Add/Edit Note\"}),/*#__PURE__*/_jsx(\"textarea\",{value:noteText,onChange:e=>setNoteText(e.target.value),placeholder:\"Add any notes about this attendance record...\",className:\"w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-900 resize-none\",rows:\"6\"})]})]})})]})});};export default DelegateDashboard;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","supabase","useAuth","Layout","Modal","Alert","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DelegateDashboard","_selectedAttendanceFo","_selectedAttendanceFo2","_selectedAttendanceFo3","_selectedAttendanceFo4","_selectedAttendanceFo5","_selectedAttendanceFo6","_selectedAttendanceFo7","currentUser","userRole","loading","navigate","activeTab","setActiveTab","sessions","setSessions","courses","setCourses","attendanceHistory","setAttendanceHistory","attendanceStats","setAttendanceStats","totalAttendance","uniqueStudents","thisMonth","lastMonth","stats","setStats","activeSessions","totalSessions","totalMarked","todaySessions","showCreateSessionModal","setShowCreateSessionModal","showAttendanceModal","setShowAttendanceModal","showNotesModal","setShowNotesModal","selectedSessionForAttendance","setSelectedSessionForAttendance","selectedAttendanceForNotes","setSelectedAttendanceForNotes","attendanceList","setAttendanceList","noteText","setNoteText","createSessionForm","setCreateSessionForm","courseId","date","Date","toISOString","split","startTime","endTime","loading2","setLoading2","error","setError","success","setSuccess","isCreating","setIsCreating","isClosing","setIsClosing","isMarking","setIsMarking","timeCountdown","setTimeCountdown","fetchAllData","interval","setInterval","prev","updated","_objectSpread","Object","keys","forEach","sessionId","session","find","s","id","now","endHour","endMin","end_time","sessionDate","session_date","setHours","parseInt","diffMs","minutes","Math","floor","seconds","concat","clearInterval","data","coursesData","from","select","order","ascending","sessionsData","sessionsWithCounts","Promise","all","map","attendanceData","eq","isActive","expires_at","attendanceCount","length","allAttendance","Set","a","student_id","size","filter","created_at","getMonth","getFullYear","prevMonth","prevYear","reduce","sum","err","console","handleCreateSession","selectedCourse","c","existingClass","classId","newClass","classError","insert","class_name","course_code","course_title","course_id","delegate_id","single","startHour","startMin","endDateTime","sessionError","class_id","token","start_time","setTimeout","message","handleCloseSession","window","confirm","update","handleMarkOwnAttendance","existing","session_id","handleViewAttendance","role","children","className","label","value","icon","bgClass","borderClass","textClass","stat","idx","action","description","onClick","slice","_session$classes","classes","_session$classes2","disabled","csv","record","_record$users","_record$users2","_record$users3","_record$sessions","_record$sessions$clas","_record$sessions2","users","name","matricule","email","toLocaleString","notes","row","cell","String","replace","join","blob","Blob","type","url","URL","createObjectURL","document","createElement","href","download","click","_record$users4","_record$users5","_record$users6","_record$sessions3","_record$sessions3$cla","_record$sessions4","toLocaleTimeString","hour","minute","second","_record$users7","_record$users8","_record$sessions5","_record$sessions6","_record$sessions6$cla","_record$users9","subject","body","open","encodeURIComponent","tab","isOpen","title","onClose","footer","onChange","e","target","course","_record$users0","_record$users1","placeholder","rows"],"sources":["C:/Users/PFI/Desktop/ATTENDANCE/ATTENDANCE/src/pages/DelegateDashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { supabase } from '../supabase/supabase';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport Layout from '../components/Layout';\r\nimport Modal from '../components/Modal';\r\nimport Alert from '../components/Alert';\r\n\r\nconst DelegateDashboard = () => {\r\n  const { currentUser, userRole, loading } = useAuth();\r\n  const navigate = useNavigate();\r\n\r\n  // State\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n  const [sessions, setSessions] = useState([]);\r\n  const [courses, setCourses] = useState([]);\r\n  const [attendanceHistory, setAttendanceHistory] = useState([]);\r\n  const [attendanceStats, setAttendanceStats] = useState({\r\n    totalAttendance: 0,\r\n    uniqueStudents: 0,\r\n    thisMonth: 0,\r\n    lastMonth: 0\r\n  });\r\n  const [stats, setStats] = useState({\r\n    activeSessions: 0,\r\n    totalSessions: 0,\r\n    totalMarked: 0,\r\n    todaySessions: 0\r\n  });\r\n\r\n  // Modal state\r\n  const [showCreateSessionModal, setShowCreateSessionModal] = useState(false);\r\n  const [showAttendanceModal, setShowAttendanceModal] = useState(false);\r\n  const [showNotesModal, setShowNotesModal] = useState(false);\r\n  const [selectedSessionForAttendance, setSelectedSessionForAttendance] = useState(null);\r\n  const [selectedAttendanceForNotes, setSelectedAttendanceForNotes] = useState(null);\r\n  const [attendanceList, setAttendanceList] = useState([]);\r\n  const [noteText, setNoteText] = useState('');\r\n\r\n  // Form state\r\n  const [createSessionForm, setCreateSessionForm] = useState({\r\n    courseId: '',\r\n    date: new Date().toISOString().split('T')[0],\r\n    startTime: '08:00',\r\n    endTime: '10:00'\r\n  });\r\n\r\n  // UI state\r\n  const [loading2, setLoading2] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [success, setSuccess] = useState(null);\r\n  const [isCreating, setIsCreating] = useState(false);\r\n  const [isClosing, setIsClosing] = useState(false);\r\n  const [isMarking, setIsMarking] = useState(false);\r\n  const [timeCountdown, setTimeCountdown] = useState({});\r\n\r\n  useEffect(() => {\r\n    if (loading) return;\r\n\r\n    if (!currentUser || userRole !== 'delegate') {\r\n      navigate('/delegate');\r\n      return;\r\n    }\r\n\r\n    fetchAllData();\r\n  }, [currentUser, userRole, loading, navigate]);\r\n\r\n  // Timer for countdown\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      setTimeCountdown(prev => {\r\n        const updated = { ...prev };\r\n        Object.keys(updated).forEach(sessionId => {\r\n          const session = sessions.find(s => s.id === sessionId);\r\n          if (session) {\r\n            const now = new Date();\r\n            const [endHour, endMin] = session.end_time.split(':');\r\n            const sessionDate = new Date(session.session_date);\r\n            const endTime = new Date(sessionDate);\r\n            endTime.setHours(parseInt(endHour), parseInt(endMin), 0);\r\n\r\n            const diffMs = endTime - now;\r\n            if (diffMs <= 0) {\r\n              delete updated[sessionId];\r\n            } else {\r\n              const minutes = Math.floor(diffMs / 60000);\r\n              const seconds = Math.floor((diffMs % 60000) / 1000);\r\n              updated[sessionId] = `${minutes}m ${seconds}s`;\r\n            }\r\n          }\r\n        });\r\n        return updated;\r\n      });\r\n    }, 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [sessions]);\r\n\r\n  const fetchAllData = async () => {\r\n    try {\r\n      setLoading2(true);\r\n      setError(null);\r\n\r\n      // Fetch courses\r\n      const { data: coursesData } = await supabase\r\n        .from('courses')\r\n        .select('id, course_code, course_title')\r\n        .order('course_code', { ascending: true });\r\n\r\n      setCourses(coursesData || []);\r\n\r\n      // Fetch sessions\r\n      const { data: sessionsData } = await supabase\r\n        .from('sessions')\r\n        .select(`\r\n          id,\r\n          session_date,\r\n          start_time,\r\n          end_time,\r\n          created_at,\r\n          expires_at,\r\n          classes (\r\n            class_name\r\n          )\r\n        `)\r\n        .order('created_at', { ascending: false });\r\n\r\n      // Get attendance counts\r\n      const sessionsWithCounts = await Promise.all(\r\n        (sessionsData || []).map(async (session) => {\r\n          const { data: attendanceData } = await supabase\r\n            .from('attendance')\r\n            .select('id')\r\n            .eq('session_id', session.id);\r\n\r\n          const isActive = new Date(session.expires_at) > new Date();\r\n          return {\r\n            ...session,\r\n            attendanceCount: attendanceData?.length || 0,\r\n            isActive\r\n          };\r\n        })\r\n      );\r\n\r\n      setSessions(sessionsWithCounts);\r\n\r\n      // Fetch attendance history from all delegate's sessions\r\n      const { data: allAttendance } = await supabase\r\n        .from('attendance')\r\n        .select(`\r\n          id,\r\n          session_id,\r\n          student_id,\r\n          notes,\r\n          created_at,\r\n          users (\r\n            name,\r\n            matricule,\r\n            email\r\n          ),\r\n          sessions (\r\n            session_date,\r\n            start_time,\r\n            end_time,\r\n            classes (\r\n              class_name\r\n            )\r\n          )\r\n        `)\r\n        .order('created_at', { ascending: false });\r\n\r\n      setAttendanceHistory(allAttendance || []);\r\n\r\n      // Calculate attendance stats\r\n      if (allAttendance && allAttendance.length > 0) {\r\n        const uniqueStudents = new Set(allAttendance.map(a => a.student_id)).size;\r\n        const now = new Date();\r\n        const thisMonth = allAttendance.filter(a => {\r\n          const date = new Date(a.created_at);\r\n          return date.getMonth() === now.getMonth() && date.getFullYear() === now.getFullYear();\r\n        }).length;\r\n        const lastMonth = allAttendance.filter(a => {\r\n          const date = new Date(a.created_at);\r\n          const prevMonth = now.getMonth() === 0 ? 11 : now.getMonth() - 1;\r\n          const prevYear = now.getMonth() === 0 ? now.getFullYear() - 1 : now.getFullYear();\r\n          return date.getMonth() === prevMonth && date.getFullYear() === prevYear;\r\n        }).length;\r\n\r\n        setAttendanceStats({\r\n          totalAttendance: allAttendance.length,\r\n          uniqueStudents,\r\n          thisMonth,\r\n          lastMonth\r\n        });\r\n      }\r\n\r\n      // Calculate stats\r\n      const activeSessions = sessionsWithCounts.filter(s => s.isActive).length;\r\n      const totalMarked = sessionsWithCounts.reduce((sum, s) => sum + s.attendanceCount, 0);\r\n      const todaySessions = sessionsWithCounts.filter(\r\n        s => s.session_date === new Date().toISOString().split('T')[0]\r\n      ).length;\r\n\r\n      setStats({\r\n        activeSessions,\r\n        totalSessions: sessionsWithCounts.length,\r\n        totalMarked,\r\n        todaySessions\r\n      });\r\n    } catch (err) {\r\n      console.error('Error fetching data:', err);\r\n      setError('Failed to load dashboard data');\r\n    } finally {\r\n      setLoading2(false);\r\n    }\r\n  };\r\n\r\n  const handleCreateSession = async () => {\r\n    if (!createSessionForm.courseId) {\r\n      setError('Please select a course');\r\n      return;\r\n    }\r\n\r\n    if (!createSessionForm.startTime || !createSessionForm.endTime) {\r\n      setError('Please set start and end times');\r\n      return;\r\n    }\r\n\r\n    if (createSessionForm.startTime >= createSessionForm.endTime) {\r\n      setError('End time must be after start time');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsCreating(true);\r\n      setError(null);\r\n\r\n      const selectedCourse = courses.find(c => c.id === createSessionForm.courseId);\r\n      if (!selectedCourse) {\r\n        setError('Selected course not found');\r\n        return;\r\n      }\r\n\r\n      // Check or create class\r\n      const { data: existingClass } = await supabase\r\n        .from('classes')\r\n        .select('id')\r\n        .eq('course_id', selectedCourse.id)\r\n        .eq('delegate_id', currentUser.id);\r\n\r\n      let classId = existingClass && existingClass.length > 0 ? existingClass[0].id : null;\r\n\r\n      if (!classId) {\r\n        const { data: newClass, error: classError } = await supabase\r\n          .from('classes')\r\n          .insert({\r\n            class_name: `${selectedCourse.course_code} - ${selectedCourse.course_title}`,\r\n            course_id: selectedCourse.id,\r\n            delegate_id: currentUser.id\r\n          })\r\n          .select('id')\r\n          .single();\r\n\r\n        if (classError) throw classError;\r\n        classId = newClass.id;\r\n      }\r\n\r\n      // Create session\r\n      const sessionDate = new Date(createSessionForm.date);\r\n      const [startHour, startMin] = createSessionForm.startTime.split(':');\r\n      const [endHour, endMin] = createSessionForm.endTime.split(':');\r\n\r\n      const endDateTime = new Date(sessionDate);\r\n      endDateTime.setHours(parseInt(endHour), parseInt(endMin), 59, 999);\r\n\r\n      const { error: sessionError } = await supabase\r\n        .from('sessions')\r\n        .insert({\r\n          class_id: classId,\r\n          token: `SESSION_${Date.now()}`,\r\n          session_date: createSessionForm.date,\r\n          start_time: createSessionForm.startTime,\r\n          end_time: createSessionForm.endTime,\r\n          expires_at: endDateTime.toISOString()\r\n        });\r\n\r\n      if (sessionError) throw sessionError;\r\n\r\n      setSuccess('âœ… Attendance session created successfully!');\r\n      setShowCreateSessionModal(false);\r\n      setCreateSessionForm({\r\n        courseId: '',\r\n        date: new Date().toISOString().split('T')[0],\r\n        startTime: '08:00',\r\n        endTime: '10:00'\r\n      });\r\n      await fetchAllData();\r\n      setTimeout(() => setSuccess(null), 3000);\r\n    } catch (err) {\r\n      console.error('Error creating session:', err);\r\n      setError(`Error: ${err.message}`);\r\n    } finally {\r\n      setIsCreating(false);\r\n    }\r\n  };\r\n\r\n  const handleCloseSession = async (sessionId) => {\r\n    if (!window.confirm('Close this session? Students will no longer be able to mark attendance.')) return;\r\n\r\n    try {\r\n      setIsClosing(true);\r\n      setError(null);\r\n\r\n      const { error } = await supabase\r\n        .from('sessions')\r\n        .update({ expires_at: new Date().toISOString() })\r\n        .eq('id', sessionId);\r\n\r\n      if (error) throw error;\r\n\r\n      setSuccess('âœ… Session closed successfully!');\r\n      await fetchAllData();\r\n      setTimeout(() => setSuccess(null), 3000);\r\n    } catch (err) {\r\n      console.error('Error closing session:', err);\r\n      setError(`Error: ${err.message}`);\r\n    } finally {\r\n      setIsClosing(false);\r\n    }\r\n  };\r\n\r\n  const handleMarkOwnAttendance = async (sessionId) => {\r\n    try {\r\n      setIsMarking(true);\r\n      setError(null);\r\n\r\n      // Check if already marked\r\n      const { data: existing } = await supabase\r\n        .from('attendance')\r\n        .select('id')\r\n        .eq('session_id', sessionId)\r\n        .eq('student_id', currentUser.id);\r\n\r\n      if (existing && existing.length > 0) {\r\n        setError('You have already marked attendance for this session');\r\n        return;\r\n      }\r\n\r\n      // Mark attendance\r\n      const { error } = await supabase\r\n        .from('attendance')\r\n        .insert({\r\n          session_id: sessionId,\r\n          student_id: currentUser.id,\r\n          created_at: new Date().toISOString()\r\n        });\r\n\r\n      if (error) throw error;\r\n\r\n      setSuccess('âœ… Your attendance has been marked!');\r\n      await fetchAllData();\r\n      setTimeout(() => setSuccess(null), 3000);\r\n    } catch (err) {\r\n      console.error('Error marking attendance:', err);\r\n      setError(`Error: ${err.message}`);\r\n    } finally {\r\n      setIsMarking(false);\r\n    }\r\n  };\r\n\r\n  const handleViewAttendance = async (sessionId) => {\r\n    try {\r\n      setError(null);\r\n      const { data, error } = await supabase\r\n        .from('attendance')\r\n        .select(`\r\n          id,\r\n          created_at,\r\n          users (\r\n            name,\r\n            matricule\r\n          )\r\n        `)\r\n        .eq('session_id', sessionId)\r\n        .order('created_at', { ascending: false });\r\n\r\n      if (error) throw error;\r\n\r\n      setSelectedSessionForAttendance(sessionId);\r\n      setAttendanceList(data || []);\r\n      setShowAttendanceModal(true);\r\n    } catch (err) {\r\n      console.error('Error fetching attendance:', err);\r\n      setError(`Error: ${err.message}`);\r\n    }\r\n  };\r\n\r\n  if (loading || loading2) {\r\n    return (\r\n      <Layout role=\"delegate\">\r\n        <div className=\"flex items-center justify-center h-screen bg-gray-50\">\r\n          <div className=\"text-center\">\r\n            <div className=\"inline-block animate-spin rounded-full h-12 w-12 border border-gray-300 border-t-blue-900 mb-4\" />\r\n            <p className=\"text-gray-600\">Loading...</p>\r\n          </div>\r\n        </div>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  if (!currentUser || userRole !== 'delegate') return null;\r\n\r\n  const activeSessions = sessions.filter(s => s.isActive);\r\n\r\n  return (\r\n    <Layout role=\"delegate\">\r\n      <div className=\"min-h-screen bg-gray-50\">\r\n        <div className=\"max-w-7xl mx-auto px-6 sm:px-8 py-12\">\r\n          \r\n          {/* Page Header */}\r\n          <div className=\"mb-12\">\r\n            <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n              <div>\r\n                <h1 className=\"text-4xl font-semibold text-gray-900\">Delegate Dashboard</h1>\r\n                <p className=\"text-gray-600 mt-2\">Manage attendance sessions and monitor student attendance</p>\r\n              </div>\r\n              <div className=\"inline-flex items-center px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg w-fit\">\r\n                <span className=\"text-xl mr-2\">ðŸ‘¤</span>\r\n                <span className=\"text-sm font-semibold text-blue-900\">Delegate</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Alerts */}\r\n          {error && (\r\n            <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800 text-sm\">\r\n              {error}\r\n            </div>\r\n          )}\r\n          {success && (\r\n            <div className=\"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg text-green-800 text-sm\">\r\n              {success}\r\n            </div>\r\n          )}\r\n\r\n          {/* ===== OVERVIEW TAB ===== */}\r\n          {activeTab === 'overview' && (\r\n            <div>\r\n              {/* Statistics Grid */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12\">\r\n                {[\r\n                  { \r\n                    label: 'Active Sessions', \r\n                    value: stats.activeSessions, \r\n                    icon: 'ðŸ”´',\r\n                    bgClass: 'bg-blue-50',\r\n                    borderClass: 'border-blue-200',\r\n                    textClass: 'text-blue-900'\r\n                  },\r\n                  { \r\n                    label: 'Total Sessions', \r\n                    value: stats.totalSessions, \r\n                    icon: 'ðŸ“‹',\r\n                    bgClass: 'bg-green-50',\r\n                    borderClass: 'border-green-200',\r\n                    textClass: 'text-green-900'\r\n                  },\r\n                  { \r\n                    label: 'Total Marked', \r\n                    value: stats.totalMarked, \r\n                    icon: 'âœ“',\r\n                    bgClass: 'bg-amber-50',\r\n                    borderClass: 'border-amber-200',\r\n                    textClass: 'text-amber-900'\r\n                  },\r\n                  { \r\n                    label: \"Today's Sessions\", \r\n                    value: stats.todaySessions, \r\n                    icon: 'ðŸ“…',\r\n                    bgClass: 'bg-purple-50',\r\n                    borderClass: 'border-purple-200',\r\n                    textClass: 'text-purple-900'\r\n                  }\r\n                ].map((stat, idx) => (\r\n                  <div key={idx} className={`${stat.bgClass} border ${stat.borderClass} rounded-lg p-6 transition-shadow hover:shadow-md`}>\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div className=\"flex-1\">\r\n                        <p className=\"text-xs font-semibold text-gray-600 uppercase tracking-wide mb-3\">\r\n                          {stat.label}\r\n                        </p>\r\n                        <p className={`text-4xl font-bold ${stat.textClass}`}>\r\n                          {stat.value}\r\n                        </p>\r\n                      </div>\r\n                      <span className=\"text-3xl opacity-50\">{stat.icon}</span>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n\r\n              {/* Quick Actions Section */}\r\n              <div className=\"mb-12\">\r\n                <h2 className=\"text-xl font-semibold text-gray-900 mb-6\">Quick Actions</h2>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  {[\r\n                    { \r\n                      label: 'Create Session', \r\n                      icon: 'âž•',\r\n                      action: () => { setActiveTab('sessions'); setShowCreateSessionModal(true); },\r\n                      description: 'Start a new attendance session'\r\n                    },\r\n                    { \r\n                      label: 'View Active Sessions', \r\n                      icon: 'ðŸ‘ï¸',\r\n                      action: () => setActiveTab('sessions'),\r\n                      description: 'See all your active sessions'\r\n                    }\r\n                  ].map((action, idx) => (\r\n                    <button\r\n                      key={idx}\r\n                      onClick={action.action}\r\n                      className=\"bg-white border border-gray-200 rounded-lg p-6 text-left hover:shadow-md hover:border-blue-300 transition-all group\"\r\n                    >\r\n                      <div className=\"flex items-start gap-4\">\r\n                        <div className=\"text-3xl\">{action.icon}</div>\r\n                        <div className=\"flex-1\">\r\n                          <h3 className=\"text-base font-semibold text-gray-900 group-hover:text-blue-900 transition-colors\">\r\n                            {action.label}\r\n                          </h3>\r\n                          <p className=\"text-sm text-gray-600 mt-1\">{action.description}</p>\r\n                        </div>\r\n                      </div>\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Active Sessions Preview */}\r\n              {activeSessions.length > 0 && (\r\n                <div className=\"bg-white border border-gray-200 rounded-lg p-8\">\r\n                  <h2 className=\"text-lg font-semibold text-gray-900 mb-6\">Active Right Now</h2>\r\n                  <div className=\"space-y-4\">\r\n                    {activeSessions.slice(0, 3).map(session => (\r\n                      <div \r\n                        key={session.id} \r\n                        className=\"p-6 border border-gray-200 rounded-lg hover:border-blue-300 hover:shadow-sm transition-all\"\r\n                      >\r\n                        <div className=\"flex justify-between items-start mb-4\">\r\n                          <div className=\"flex-1\">\r\n                            <h3 className=\"text-base font-semibold text-gray-900\">{session.classes?.class_name}</h3>\r\n                            <div className=\"flex gap-4 mt-2 text-sm text-gray-600\">\r\n                              <span>ðŸ“… {session.session_date}</span>\r\n                              <span>ðŸ• {session.start_time} - {session.end_time}</span>\r\n                            </div>\r\n                          </div>\r\n                          <span className=\"px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-semibold\">â— ACTIVE</span>\r\n                        </div>\r\n                        <div className=\"flex justify-between items-center pt-4 border-t border-gray-100\">\r\n                          <span className=\"text-sm text-gray-600\">\r\n                            <span className=\"font-semibold text-gray-900\">{session.attendanceCount}</span> students marked\r\n                          </span>\r\n                          {timeCountdown[session.id] && (\r\n                            <span className=\"text-sm font-medium text-blue-900\">â± {timeCountdown[session.id]}</span>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {activeSessions.length === 0 && (\r\n                <div className=\"bg-white border border-gray-200 rounded-lg p-12 text-center\">\r\n                  <p className=\"text-gray-500 text-lg\">No active sessions right now</p>\r\n                  <p className=\"text-gray-400 text-sm mt-2\">Create a new session to get started</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* ===== SESSIONS TAB ===== */}\r\n          {activeTab === 'sessions' && (\r\n            <div>\r\n              <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8\">\r\n                <div>\r\n                  <h2 className=\"text-2xl font-semibold text-gray-900\">Sessions</h2>\r\n                  <p className=\"text-gray-600 text-sm mt-2\">{sessions.length} total sessions</p>\r\n                </div>\r\n                <button\r\n                  onClick={() => setShowCreateSessionModal(true)}\r\n                  className=\"px-6 py-3 bg-blue-900 text-white rounded-lg text-sm font-semibold hover:bg-blue-800 transition-colors inline-flex items-center gap-2 w-fit\"\r\n                >\r\n                  <span>âž•</span> Create Session\r\n                </button>\r\n              </div>\r\n\r\n              {/* Sessions Table */}\r\n              <div className=\"bg-white border border-gray-200 rounded-lg overflow-hidden\">\r\n                {sessions.length > 0 ? (\r\n                  <>\r\n                    <div className=\"overflow-x-auto\">\r\n                      <table className=\"w-full\">\r\n                        <thead>\r\n                          <tr className=\"bg-gray-50 border-b border-gray-200\">\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">Course</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">Date</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">Time</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">Marked</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">Status</th>\r\n                            <th className=\"px-6 py-4 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider\">Actions</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y divide-gray-200\">\r\n                          {sessions.map((session) => (\r\n                            <tr key={session.id} className=\"hover:bg-gray-50 transition-colors\">\r\n                              <td className=\"px-6 py-4 text-sm font-medium text-gray-900\">{session.classes?.class_name}</td>\r\n                              <td className=\"px-6 py-4 text-sm text-gray-600\">{session.session_date}</td>\r\n                              <td className=\"px-6 py-4 text-sm text-gray-600\">{session.start_time} - {session.end_time}</td>\r\n                              <td className=\"px-6 py-4 text-sm font-semibold text-gray-900\">{session.attendanceCount}</td>\r\n                              <td className=\"px-6 py-4 text-sm\">\r\n                                <span className={`px-3 py-1 rounded-full text-xs font-semibold ${\r\n                                  session.isActive\r\n                                    ? 'bg-green-100 text-green-800'\r\n                                    : 'bg-gray-100 text-gray-600'\r\n                                }`}>\r\n                                  {session.isActive ? 'â— ACTIVE' : 'â—‹ CLOSED'}\r\n                                </span>\r\n                              </td>\r\n                              <td className=\"px-6 py-4 text-center\">\r\n                                <div className=\"flex gap-2 justify-center\">\r\n                                  <button\r\n                                    onClick={() => handleViewAttendance(session.id)}\r\n                                    className=\"px-3 py-1.5 bg-blue-100 text-blue-700 rounded text-xs font-semibold hover:bg-blue-200 transition-colors\"\r\n                                  >\r\n                                    View\r\n                                  </button>\r\n                                  {session.isActive && (\r\n                                    <>\r\n                                      <button\r\n                                        onClick={() => handleMarkOwnAttendance(session.id)}\r\n                                        disabled={isMarking}\r\n                                        className=\"px-3 py-1.5 bg-green-100 text-green-700 rounded text-xs font-semibold hover:bg-green-200 transition-colors disabled:opacity-50\"\r\n                                      >\r\n                                        Mark\r\n                                      </button>\r\n                                      <button\r\n                                        onClick={() => handleCloseSession(session.id)}\r\n                                        disabled={isClosing}\r\n                                        className=\"px-3 py-1.5 bg-red-100 text-red-700 rounded text-xs font-semibold hover:bg-red-200 transition-colors disabled:opacity-50\"\r\n                                      >\r\n                                        Close\r\n                                      </button>\r\n                                    </>\r\n                                  )}\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          ))}\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </>\r\n                ) : (\r\n                  <div className=\"px-6 py-16 text-center\">\r\n                    <p className=\"text-gray-600 text-lg\">No sessions created yet</p>\r\n                    <p className=\"text-gray-400 text-sm mt-2\">Create your first session to get started</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* ===== ATTENDANCE HISTORY TAB ===== */}\r\n          {activeTab === 'attendance-history' && (\r\n            <div>\r\n              <div className=\"mb-8\">\r\n                <h2 className=\"text-2xl font-semibold text-gray-900\">Attendance History</h2>\r\n                <p className=\"text-gray-600 text-sm mt-2\">Complete record of all attendance marked across your sessions</p>\r\n              </div>\r\n\r\n              {/* Attendance Stats Grid */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12\">\r\n                {[\r\n                  { \r\n                    label: 'Total Attendance Records', \r\n                    value: attendanceStats.totalAttendance, \r\n                    icon: 'ðŸ“Š',\r\n                    bgClass: 'bg-blue-50',\r\n                    borderClass: 'border-blue-200',\r\n                    textClass: 'text-blue-900'\r\n                  },\r\n                  { \r\n                    label: 'Unique Students', \r\n                    value: attendanceStats.uniqueStudents, \r\n                    icon: 'ðŸ‘¥',\r\n                    bgClass: 'bg-green-50',\r\n                    borderClass: 'border-green-200',\r\n                    textClass: 'text-green-900'\r\n                  },\r\n                  { \r\n                    label: 'This Month', \r\n                    value: attendanceStats.thisMonth, \r\n                    icon: 'ðŸ“…',\r\n                    bgClass: 'bg-amber-50',\r\n                    borderClass: 'border-amber-200',\r\n                    textClass: 'text-amber-900'\r\n                  },\r\n                  { \r\n                    label: 'Last Month', \r\n                    value: attendanceStats.lastMonth, \r\n                    icon: 'ðŸ“ˆ',\r\n                    bgClass: 'bg-purple-50',\r\n                    borderClass: 'border-purple-200',\r\n                    textClass: 'text-purple-900'\r\n                  }\r\n                ].map((stat, idx) => (\r\n                  <div key={idx} className={`${stat.bgClass} border ${stat.borderClass} rounded-lg p-6 transition-shadow hover:shadow-md`}>\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div className=\"flex-1\">\r\n                        <p className=\"text-xs font-semibold text-gray-600 uppercase tracking-wide mb-3\">\r\n                          {stat.label}\r\n                        </p>\r\n                        <p className={`text-4xl font-bold ${stat.textClass}`}>\r\n                          {stat.value}\r\n                        </p>\r\n                      </div>\r\n                      <span className=\"text-3xl opacity-50\">{stat.icon}</span>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n\r\n              {/* Attendance Records Table */}\r\n              <div className=\"bg-white border border-gray-200 rounded-lg overflow-hidden\">\r\n                {attendanceHistory.length > 0 ? (\r\n                  <>\r\n                    <div className=\"p-6 flex justify-between items-center border-b border-gray-200 bg-gray-50\">\r\n                      <h3 className=\"text-lg font-semibold text-gray-900\">Attendance Records ({attendanceHistory.length})</h3>\r\n                      <button\r\n                        onClick={() => {\r\n                          // Export to CSV\r\n                          const csv = [\r\n                            ['Name', 'Matricule', 'Email', 'Course', 'Date', 'Time Marked', 'Notes'],\r\n                            ...attendanceHistory.map(record => [\r\n                              record.users?.name || 'Unknown',\r\n                              record.users?.matricule || 'N/A',\r\n                              record.users?.email || 'N/A',\r\n                              record.sessions?.classes?.class_name || 'N/A',\r\n                              record.sessions?.session_date || 'N/A',\r\n                              new Date(record.created_at).toLocaleString(),\r\n                              record.notes || ''\r\n                            ])\r\n                          ].map(row => row.map(cell => `\"${String(cell).replace(/\"/g, '\"\"')}\"`).join(',')).join('\\n');\r\n                          \r\n                          const blob = new Blob([csv], { type: 'text/csv' });\r\n                          const url = window.URL.createObjectURL(blob);\r\n                          const a = document.createElement('a');\r\n                          a.href = url;\r\n                          a.download = `attendance-history-${new Date().toISOString().split('T')[0]}.csv`;\r\n                          a.click();\r\n                        }}\r\n                        className=\"px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-semibold hover:bg-green-700 transition-colors inline-flex items-center gap-2\"\r\n                      >\r\n                        <span>ðŸ“¥</span> Export CSV\r\n                      </button>\r\n                    </div>\r\n                    <div className=\"overflow-x-auto\">\r\n                      <table className=\"w-full\">\r\n                        <thead>\r\n                          <tr className=\"bg-gray-50 border-b border-gray-200\">\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">Name</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">Matricule</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">Email</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">Course</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">Date</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider\">Time Marked</th>\r\n                            <th className=\"px-6 py-4 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider\">Actions</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y divide-gray-200\">\r\n                          {attendanceHistory.map((record) => (\r\n                            <tr key={record.id} className=\"hover:bg-gray-50 transition-colors\">\r\n                              <td className=\"px-6 py-4 text-sm font-medium text-gray-900\">{record.users?.name || 'Unknown'}</td>\r\n                              <td className=\"px-6 py-4 text-sm font-mono text-gray-600\">{record.users?.matricule || 'N/A'}</td>\r\n                              <td className=\"px-6 py-4 text-sm text-gray-600\">{record.users?.email || 'N/A'}</td>\r\n                              <td className=\"px-6 py-4 text-sm text-gray-600\">{record.sessions?.classes?.class_name || 'N/A'}</td>\r\n                              <td className=\"px-6 py-4 text-sm text-gray-600\">{record.sessions?.session_date || 'N/A'}</td>\r\n                              <td className=\"px-6 py-4 text-sm text-gray-600\">\r\n                                <span className=\"inline-flex items-center gap-2\">\r\n                                  <span>ðŸ•</span>\r\n                                  {new Date(record.created_at).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' })}\r\n                                </span>\r\n                              </td>\r\n                              <td className=\"px-6 py-4 text-center\">\r\n                                <div className=\"flex gap-2 justify-center\">\r\n                                  <button\r\n                                    onClick={() => {\r\n                                      setSelectedAttendanceForNotes(record);\r\n                                      setNoteText(record.notes || '');\r\n                                      setShowNotesModal(true);\r\n                                    }}\r\n                                    className=\"px-3 py-1.5 bg-blue-100 text-blue-700 rounded text-xs font-semibold hover:bg-blue-200 transition-colors\"\r\n                                  >\r\n                                    {record.notes ? 'ðŸ“ View' : 'âœŽ Add'} Note\r\n                                  </button>\r\n                                  <button\r\n                                    onClick={() => {\r\n                                      const subject = `Attendance Confirmation - ${record.users?.name}`;\r\n                                      const body = `Dear ${record.users?.name},\\n\\nYour attendance has been recorded on ${record.sessions?.session_date} at ${new Date(record.created_at).toLocaleTimeString()} for ${record.sessions?.classes?.class_name}.\\n\\nBest regards`;\r\n                                      window.open(`mailto:${record.users?.email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`, '_blank');\r\n                                    }}\r\n                                    className=\"px-3 py-1.5 bg-purple-100 text-purple-700 rounded text-xs font-semibold hover:bg-purple-200 transition-colors\"\r\n                                  >\r\n                                    ðŸ“§ Email\r\n                                  </button>\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          ))}\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </>\r\n                ) : (\r\n                  <div className=\"px-6 py-16 text-center\">\r\n                    <p className=\"text-gray-600 text-lg\">No attendance records yet</p>\r\n                    <p className=\"text-gray-400 text-sm mt-2\">Attendance records will appear here as students mark attendance in sessions</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Tab Navigation */}\r\n          <div className=\"flex gap-8 mt-12 border-t border-gray-200 pt-6\">\r\n            {[\r\n              { id: 'overview', label: 'Overview' },\r\n              { id: 'sessions', label: 'Sessions' },\r\n              { id: 'attendance-history', label: 'Attendance History' }\r\n            ].map(tab => (\r\n              <button\r\n                key={tab.id}\r\n                onClick={() => setActiveTab(tab.id)}\r\n                className={`px-4 py-2 text-sm font-semibold transition-colors ${\r\n                  activeTab === tab.id\r\n                    ? 'text-blue-900 border-b-2 border-blue-900'\r\n                    : 'text-gray-600 hover:text-gray-900'\r\n                }`}\r\n              >\r\n                {tab.label}\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* ===== MODALS ===== */}\r\n\r\n        {/* Create Session Modal */}\r\n        <Modal\r\n          isOpen={showCreateSessionModal}\r\n          title=\"Create Attendance Session\"\r\n          onClose={() => setShowCreateSessionModal(false)}\r\n          size=\"md\"\r\n          footer={\r\n            <>\r\n              <button\r\n                onClick={() => setShowCreateSessionModal(false)}\r\n                className=\"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={handleCreateSession}\r\n                disabled={isCreating}\r\n                className=\"px-4 py-2 bg-blue-900 text-white rounded-lg text-sm font-medium hover:bg-blue-800 disabled:opacity-50\"\r\n              >\r\n                {isCreating ? 'Creating...' : 'Create Session'}\r\n              </button>\r\n            </>\r\n          }\r\n        >\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-semibold text-gray-900 mb-2\">Course *</label>\r\n              <select\r\n                value={createSessionForm.courseId}\r\n                onChange={(e) => setCreateSessionForm(prev => ({ ...prev, courseId: e.target.value }))}\r\n                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-900\"\r\n              >\r\n                <option value=\"\">Select a course</option>\r\n                {courses.map(course => (\r\n                  <option key={course.id} value={course.id}>\r\n                    {course.course_code} - {course.course_title}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-semibold text-gray-900 mb-2\">Date *</label>\r\n              <input\r\n                type=\"date\"\r\n                value={createSessionForm.date}\r\n                onChange={(e) => setCreateSessionForm(prev => ({ ...prev, date: e.target.value }))}\r\n                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-900\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-900 mb-2\">Start Time *</label>\r\n                <input\r\n                  type=\"time\"\r\n                  value={createSessionForm.startTime}\r\n                  onChange={(e) => setCreateSessionForm(prev => ({ ...prev, startTime: e.target.value }))}\r\n                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-900\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-900 mb-2\">End Time *</label>\r\n                <input\r\n                  type=\"time\"\r\n                  value={createSessionForm.endTime}\r\n                  onChange={(e) => setCreateSessionForm(prev => ({ ...prev, endTime: e.target.value }))}\r\n                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-900\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </Modal>\r\n\r\n        {/* Attendance List Modal */}\r\n        <Modal\r\n          isOpen={showAttendanceModal}\r\n          title=\"Attendance Records\"\r\n          onClose={() => {\r\n            setShowAttendanceModal(false);\r\n            setSelectedSessionForAttendance(null);\r\n            setAttendanceList([]);\r\n          }}\r\n          size=\"lg\"\r\n          footer={\r\n            <button\r\n              onClick={() => {\r\n                setShowAttendanceModal(false);\r\n                setSelectedSessionForAttendance(null);\r\n                setAttendanceList([]);\r\n              }}\r\n              className=\"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\"\r\n            >\r\n              Close\r\n            </button>\r\n          }\r\n        >\r\n          <div>\r\n            {attendanceList.length > 0 ? (\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full text-sm\">\r\n                  <thead>\r\n                    <tr className=\"bg-gray-50 border-b border-gray-200\">\r\n                      <th className=\"px-4 py-3 text-left font-semibold text-gray-700 uppercase text-xs tracking-wider\">Name</th>\r\n                      <th className=\"px-4 py-3 text-left font-semibold text-gray-700 uppercase text-xs tracking-wider\">Matricule</th>\r\n                      <th className=\"px-4 py-3 text-left font-semibold text-gray-700 uppercase text-xs tracking-wider\">Time Marked</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody className=\"divide-y divide-gray-200\">\r\n                    {attendanceList.map((record) => (\r\n                      <tr key={record.id} className=\"hover:bg-gray-50\">\r\n                        <td className=\"px-4 py-3 font-medium text-gray-900\">{record.users?.name || 'Unknown'}</td>\r\n                        <td className=\"px-4 py-3 text-gray-600 font-mono text-sm\">{record.users?.matricule || 'N/A'}</td>\r\n                        <td className=\"px-4 py-3 text-gray-600\">\r\n                          {new Date(record.created_at).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            ) : (\r\n              <div className=\"py-8 text-center text-gray-600\">\r\n                No attendance records yet\r\n              </div>\r\n            )}\r\n          </div>\r\n        </Modal>\r\n\r\n        {/* Attendance Notes Modal */}\r\n        <Modal\r\n          isOpen={showNotesModal}\r\n          title={`Notes - ${selectedAttendanceForNotes?.users?.name}`}\r\n          onClose={() => {\r\n            setShowNotesModal(false);\r\n            setSelectedAttendanceForNotes(null);\r\n            setNoteText('');\r\n          }}\r\n          size=\"md\"\r\n          footer={\r\n            <>\r\n              <button\r\n                onClick={() => {\r\n                  setShowNotesModal(false);\r\n                  setSelectedAttendanceForNotes(null);\r\n                  setNoteText('');\r\n                }}\r\n                className=\"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={async () => {\r\n                  if (!selectedAttendanceForNotes) return;\r\n                  try {\r\n                    const { error } = await supabase\r\n                      .from('attendance')\r\n                      .update({ notes: noteText })\r\n                      .eq('id', selectedAttendanceForNotes.id);\r\n\r\n                    if (error) throw error;\r\n\r\n                    setSuccess('âœ… Note saved successfully!');\r\n                    await fetchAllData();\r\n                    setShowNotesModal(false);\r\n                    setSelectedAttendanceForNotes(null);\r\n                    setNoteText('');\r\n                    setTimeout(() => setSuccess(null), 3000);\r\n                  } catch (err) {\r\n                    console.error('Error saving note:', err);\r\n                    setError(`Error: ${err.message}`);\r\n                  }\r\n                }}\r\n                className=\"px-4 py-2 bg-blue-900 text-white rounded-lg text-sm font-medium hover:bg-blue-800\"\r\n              >\r\n                Save Note\r\n              </button>\r\n            </>\r\n          }\r\n        >\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-semibold text-gray-900 mb-2\">Student Info</label>\r\n              <div className=\"bg-gray-50 p-4 rounded-lg space-y-2\">\r\n                <p className=\"text-sm\"><span className=\"font-semibold text-gray-700\">Name:</span> {selectedAttendanceForNotes?.users?.name}</p>\r\n                <p className=\"text-sm\"><span className=\"font-semibold text-gray-700\">Matricule:</span> {selectedAttendanceForNotes?.users?.matricule}</p>\r\n                <p className=\"text-sm\"><span className=\"font-semibold text-gray-700\">Email:</span> {selectedAttendanceForNotes?.users?.email}</p>\r\n                <p className=\"text-sm\"><span className=\"font-semibold text-gray-700\">Course:</span> {selectedAttendanceForNotes?.sessions?.classes?.class_name}</p>\r\n                <p className=\"text-sm\"><span className=\"font-semibold text-gray-700\">Date:</span> {selectedAttendanceForNotes?.sessions?.session_date}</p>\r\n                <p className=\"text-sm\"><span className=\"font-semibold text-gray-700\">Time Marked:</span> {selectedAttendanceForNotes?.created_at && new Date(selectedAttendanceForNotes.created_at).toLocaleString()}</p>\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-semibold text-gray-900 mb-2\">Add/Edit Note</label>\r\n              <textarea\r\n                value={noteText}\r\n                onChange={(e) => setNoteText(e.target.value)}\r\n                placeholder=\"Add any notes about this attendance record...\"\r\n                className=\"w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-900 resize-none\"\r\n                rows=\"6\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </Modal>\r\n      </div>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default DelegateDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}