{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{supabase}from'../supabase/supabase';import{useAuth}from'../contexts/AuthContext';import Layout from'../components/Layout';import Card from'../components/Card';import Button from'../components/Button';import Badge from'../components/Badge';import Alert from'../components/Alert';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const StudentDashboard=()=>{const{currentUser,userRole,loading}=useAuth();const navigate=useNavigate();// Active session state\nconst[activeSession,setActiveSession]=useState(null);const[sessionsLoading,setSessionsLoading]=useState(true);const[marking,setMarking]=useState(false);const[timeRemaining,setTimeRemaining]=useState(null);// Attendance summary\nconst[attendanceSummary,setAttendanceSummary]=useState({totalAttended:0,totalSessions:0,percentage:0});const[summaryLoading,setSummaryLoading]=useState(true);// Course attendance\nconst[courseAttendance,setCourseAttendance]=useState([]);const[courseLoading,setCourseLoading]=useState(true);// UI state\nconst[error,setError]=useState(null);const[success,setSuccess]=useState(null);// Protect route - only allow students\nuseEffect(()=>{if(loading)return;if(!currentUser||userRole!=='student'){navigate('/student');return;}fetchActiveSession();fetchAttendanceSummary();fetchCourseAttendance();},[currentUser,userRole,loading,navigate]);// Timer for session countdown\nuseEffect(()=>{if(!activeSession)return;const timer=setInterval(()=>{const now=new Date();const[endHour,endMin]=activeSession.end_time.split(':');const sessionDate=new Date(activeSession.session_date);const endTime=new Date(sessionDate);endTime.setHours(parseInt(endHour),parseInt(endMin),0);const diffMs=endTime-now;if(diffMs<=0){setTimeRemaining(null);setActiveSession(null);clearInterval(timer);}else{const minutes=Math.floor(diffMs/60000);const seconds=Math.floor(diffMs%60000/1000);setTimeRemaining(\"\".concat(minutes,\" min \").concat(seconds,\" sec remaining\"));}},1000);return()=>clearInterval(timer);},[activeSession]);const fetchActiveSession=async()=>{try{setSessionsLoading(true);const now=new Date();// Get the next/currently active session\nconst{data,error}=await supabase.from('sessions').select(\"\\n          id,\\n          session_date,\\n          start_time,\\n          end_time,\\n          classes (\\n            id,\\n            class_name,\\n            delegate_id,\\n            users!delegate_id (\\n              name\\n            ),\\n            courses (\\n              course_code,\\n              course_title\\n            )\\n          )\\n        \").order('start_time',{ascending:false});if(error)throw error;// Find the first active session (current or upcoming)\nconst active=(data||[]).find(session=>{if(!session.session_date||!session.end_time)return false;const sessionDate=new Date(session.session_date);const[startHour,startMin]=session.start_time.split(':');const[endHour,endMin]=session.end_time.split(':');const sessionStart=new Date(sessionDate);sessionStart.setHours(parseInt(startHour),parseInt(startMin),0);const sessionEnd=new Date(sessionDate);sessionEnd.setHours(parseInt(endHour),parseInt(endMin),0);// Show if currently happening\nreturn now>=sessionStart&&now<=sessionEnd;});setActiveSession(active||null);}catch(err){console.error('Error fetching active session:',err);setActiveSession(null);}finally{setSessionsLoading(false);}};const fetchAttendanceSummary=async()=>{try{setSummaryLoading(true);// Get attendance records\nconst{data:records}=await supabase.from('attendance').select('id').eq('student_id',currentUser.id);// Get all sessions\nconst{data:sessions}=await supabase.from('sessions').select('id');const totalAttended=(records||[]).length;const totalSessions=(sessions||[]).length;const percentage=totalSessions>0?Math.round(totalAttended/totalSessions*100):0;setAttendanceSummary({totalAttended,totalSessions,percentage});}catch(err){console.error('Error fetching summary:',err);}finally{setSummaryLoading(false);}};const fetchCourseAttendance=async()=>{try{setCourseLoading(true);const{data:records}=await supabase.from('attendance').select(\"\\n          id,\\n          sessions (\\n            classes (\\n              courses (\\n                id,\\n                course_code,\\n                course_title\\n              )\\n            )\\n          )\\n        \").eq('student_id',currentUser.id);// Group by course and count\nconst courseMap={};(records||[]).forEach(record=>{var _record$sessions,_record$sessions$clas;const course=(_record$sessions=record.sessions)===null||_record$sessions===void 0?void 0:(_record$sessions$clas=_record$sessions.classes)===null||_record$sessions$clas===void 0?void 0:_record$sessions$clas.courses;if(course&&!courseMap[course.id]){courseMap[course.id]={id:course.id,code:course.course_code,title:course.course_title,attended:0};}if(course){courseMap[course.id].attended++;}});// Get total sessions per course\nconst{data:allSessions}=await supabase.from('sessions').select(\"\\n          id,\\n          classes (\\n            courses (id)\\n          )\\n        \");Object.values(courseMap).forEach(course=>{const total=(allSessions||[]).filter(s=>{var _s$classes,_s$classes$courses;return((_s$classes=s.classes)===null||_s$classes===void 0?void 0:(_s$classes$courses=_s$classes.courses)===null||_s$classes$courses===void 0?void 0:_s$classes$courses.id)===course.id;}).length;course.total=total||course.attended;course.percentage=course.total>0?Math.round(course.attended/course.total*100):0;course.eligible=course.percentage>=75;});setCourseAttendance(Object.values(courseMap));}catch(err){console.error('Error fetching course attendance:',err);}finally{setCourseLoading(false);}};const handleMarkAttendance=async()=>{if(!activeSession){setError('No active session to mark');return;}try{setMarking(true);setError(null);// Validate session time\nconst now=new Date();const[startHour,startMin]=activeSession.start_time.split(':');const[endHour,endMin]=activeSession.end_time.split(':');const startTime=new Date();startTime.setHours(parseInt(startHour),parseInt(startMin),0);const endTime=new Date();endTime.setHours(parseInt(endHour),parseInt(endMin),59);if(now<startTime||now>endTime){setError('Attendance can only be marked during the session time window');return;}// Check for existing attendance\nconst{data:existing}=await supabase.from('attendance').select('id').eq('session_id',activeSession.id).eq('student_id',currentUser.id).single();if(existing){setError('You have already marked attendance for this session');return;}// Insert attendance\nconst{error:insertError}=await supabase.from('attendance').insert({session_id:activeSession.id,student_id:currentUser.id,created_at:new Date().toISOString()});if(insertError)throw insertError;setSuccess('Attendance marked successfully');setActiveSession(null);fetchActiveSession();fetchAttendanceSummary();fetchCourseAttendance();setTimeout(()=>setSuccess(null),3000);}catch(err){console.error('Error marking attendance:',err);setError(err.message);}finally{setMarking(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-screen bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-block animate-spin rounded-full h-12 w-12 border border-gray-300 border-t-black mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Loading...\"})]})});}if(!currentUser||userRole!=='student'){return null;}return/*#__PURE__*/_jsx(Layout,{role:\"student\",children:/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6 p-4 bg-red-50 border border-red-200 rounded text-red-800 text-sm\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-6 p-4 bg-green-50 border border-green-200 rounded text-green-800 text-sm\",children:success}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-medium text-gray-900 mb-8\",children:\"Dashboard\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:sessionsLoading?/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border border-gray-200 rounded p-8 text-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Loading session data...\"})}):activeSession?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white border border-gray-200 rounded shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-gray-200 px-6 py-4\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-medium text-gray-900\",children:\"Mark Attendance\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 font-medium uppercase tracking-wide\",children:\"Course\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xl text-gray-900 mt-1\",children:[activeSession.classes.courses.course_code,\" - \",activeSession.classes.courses.course_title]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 font-medium uppercase tracking-wide\",children:\"Session Date\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-base text-gray-900 mt-1\",children:activeSession.session_date})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 font-medium uppercase tracking-wide\",children:\"Session Time\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-base text-gray-900 mt-1\",children:[activeSession.start_time,\" \\u2013 \",activeSession.end_time]})]})]}),activeSession.classes.users&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 font-medium uppercase tracking-wide\",children:\"Instructor\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-base text-gray-900 mt-1\",children:activeSession.classes.users.name})]}),timeRemaining&&/*#__PURE__*/_jsxs(\"div\",{className:\"pt-4 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 font-medium uppercase tracking-wide\",children:\"Time Remaining\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-base text-black font-medium mt-1\",children:timeRemaining})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleMarkAttendance,disabled:marking,className:\"w-full px-6 py-3 bg-black text-white font-medium rounded hover:bg-gray-800 disabled:bg-gray-400 transition-colors\",children:marking?'Marking...':'Mark Attendance'})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border border-gray-200 rounded shadow-sm p-8 text-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"There are no active sessions at the moment.\"})})}),!summaryLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white border border-gray-200 rounded shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-gray-200 px-6 py-4\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-medium text-gray-900\",children:\"Attendance Summary\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 font-medium uppercase tracking-wide\",children:\"Sessions Attended\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-medium text-gray-900 mt-2\",children:attendanceSummary.totalAttended})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 font-medium uppercase tracking-wide\",children:\"Total Sessions\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-medium text-gray-900 mt-2\",children:attendanceSummary.totalSessions})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 font-medium uppercase tracking-wide\",children:\"Attendance Rate\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-medium text-gray-900 mt-2\",children:[attendanceSummary.percentage,\"%\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 w-full bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-2 rounded-full transition-all \".concat(attendanceSummary.percentage>=75?'bg-green-600':'bg-amber-600'),style:{width:\"\".concat(Math.min(attendanceSummary.percentage,100),\"%\")}})})]})]})})]})}),!courseLoading&&courseAttendance.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white border border-gray-200 rounded shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-gray-200 px-6 py-4\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-medium text-gray-900\",children:\"Course Attendance\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"divide-y divide-gray-200\",children:courseAttendance.map(course=>/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-base font-medium text-gray-900\",children:course.code}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:course.title})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium \".concat(course.eligible?'text-green-700':'text-amber-700'),children:course.eligible?'ELIGIBLE':'AT RISK'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-3\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[course.attended,\" of \",course.total,\" sessions\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm font-medium text-gray-900\",children:[course.percentage,\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2 mb-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-2 rounded-full transition-all \".concat(course.eligible?'bg-green-600':'bg-amber-600'),style:{width:\"\".concat(Math.min(course.percentage,100),\"%\")}})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/student/history?course=\".concat(course.id)),className:\"text-sm text-black font-medium hover:text-gray-700\",children:\"View Details \\u2192\"})]},course.id))})]})}),!courseLoading&&courseAttendance.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border border-gray-200 rounded shadow-sm p-8 text-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"No attendance records yet.\"})})]})})});};export default StudentDashboard;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","supabase","useAuth","Layout","Card","Button","Badge","Alert","jsx","_jsx","jsxs","_jsxs","StudentDashboard","currentUser","userRole","loading","navigate","activeSession","setActiveSession","sessionsLoading","setSessionsLoading","marking","setMarking","timeRemaining","setTimeRemaining","attendanceSummary","setAttendanceSummary","totalAttended","totalSessions","percentage","summaryLoading","setSummaryLoading","courseAttendance","setCourseAttendance","courseLoading","setCourseLoading","error","setError","success","setSuccess","fetchActiveSession","fetchAttendanceSummary","fetchCourseAttendance","timer","setInterval","now","Date","endHour","endMin","end_time","split","sessionDate","session_date","endTime","setHours","parseInt","diffMs","clearInterval","minutes","Math","floor","seconds","concat","data","from","select","order","ascending","active","find","session","startHour","startMin","start_time","sessionStart","sessionEnd","err","console","records","eq","id","sessions","length","round","courseMap","forEach","record","_record$sessions","_record$sessions$clas","course","classes","courses","code","course_code","title","course_title","attended","allSessions","Object","values","total","filter","s","_s$classes","_s$classes$courses","eligible","handleMarkAttendance","startTime","existing","single","insertError","insert","session_id","student_id","created_at","toISOString","setTimeout","message","className","children","role","users","name","onClick","disabled","style","width","min","map"],"sources":["C:/Users/PFI/Desktop/ATTENDANCE/ATTENDANCE/src/pages/StudentDashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { supabase } from '../supabase/supabase';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport Layout from '../components/Layout';\r\nimport Card from '../components/Card';\r\nimport Button from '../components/Button';\r\nimport Badge from '../components/Badge';\r\nimport Alert from '../components/Alert';\r\n\r\nconst StudentDashboard = () => {\r\n  const { currentUser, userRole, loading } = useAuth();\r\n  const navigate = useNavigate();\r\n  \r\n  // Active session state\r\n  const [activeSession, setActiveSession] = useState(null);\r\n  const [sessionsLoading, setSessionsLoading] = useState(true);\r\n  const [marking, setMarking] = useState(false);\r\n  const [timeRemaining, setTimeRemaining] = useState(null);\r\n  \r\n  // Attendance summary\r\n  const [attendanceSummary, setAttendanceSummary] = useState({\r\n    totalAttended: 0,\r\n    totalSessions: 0,\r\n    percentage: 0\r\n  });\r\n  const [summaryLoading, setSummaryLoading] = useState(true);\r\n  \r\n  // Course attendance\r\n  const [courseAttendance, setCourseAttendance] = useState([]);\r\n  const [courseLoading, setCourseLoading] = useState(true);\r\n  \r\n  // UI state\r\n  const [error, setError] = useState(null);\r\n  const [success, setSuccess] = useState(null);\r\n\r\n  // Protect route - only allow students\r\n  useEffect(() => {\r\n    if (loading) return;\r\n\r\n    if (!currentUser || userRole !== 'student') {\r\n      navigate('/student');\r\n      return;\r\n    }\r\n\r\n    fetchActiveSession();\r\n    fetchAttendanceSummary();\r\n    fetchCourseAttendance();\r\n  }, [currentUser, userRole, loading, navigate]);\r\n\r\n  // Timer for session countdown\r\n  useEffect(() => {\r\n    if (!activeSession) return;\r\n\r\n    const timer = setInterval(() => {\r\n      const now = new Date();\r\n      const [endHour, endMin] = activeSession.end_time.split(':');\r\n      \r\n      const sessionDate = new Date(activeSession.session_date);\r\n      const endTime = new Date(sessionDate);\r\n      endTime.setHours(parseInt(endHour), parseInt(endMin), 0);\r\n      \r\n      const diffMs = endTime - now;\r\n      \r\n      if (diffMs <= 0) {\r\n        setTimeRemaining(null);\r\n        setActiveSession(null);\r\n        clearInterval(timer);\r\n      } else {\r\n        const minutes = Math.floor(diffMs / 60000);\r\n        const seconds = Math.floor((diffMs % 60000) / 1000);\r\n        setTimeRemaining(`${minutes} min ${seconds} sec remaining`);\r\n      }\r\n    }, 1000);\r\n\r\n    return () => clearInterval(timer);\r\n  }, [activeSession]);\r\n\r\n  const fetchActiveSession = async () => {\r\n    try {\r\n      setSessionsLoading(true);\r\n      const now = new Date();\r\n\r\n      // Get the next/currently active session\r\n      const { data, error } = await supabase\r\n        .from('sessions')\r\n        .select(`\r\n          id,\r\n          session_date,\r\n          start_time,\r\n          end_time,\r\n          classes (\r\n            id,\r\n            class_name,\r\n            delegate_id,\r\n            users!delegate_id (\r\n              name\r\n            ),\r\n            courses (\r\n              course_code,\r\n              course_title\r\n            )\r\n          )\r\n        `)\r\n        .order('start_time', { ascending: false });\r\n\r\n      if (error) throw error;\r\n      \r\n      // Find the first active session (current or upcoming)\r\n      const active = (data || []).find(session => {\r\n        if (!session.session_date || !session.end_time) return false;\r\n        \r\n        const sessionDate = new Date(session.session_date);\r\n        const [startHour, startMin] = session.start_time.split(':');\r\n        const [endHour, endMin] = session.end_time.split(':');\r\n        \r\n        const sessionStart = new Date(sessionDate);\r\n        sessionStart.setHours(parseInt(startHour), parseInt(startMin), 0);\r\n        \r\n        const sessionEnd = new Date(sessionDate);\r\n        sessionEnd.setHours(parseInt(endHour), parseInt(endMin), 0);\r\n        \r\n        // Show if currently happening\r\n        return now >= sessionStart && now <= sessionEnd;\r\n      });\r\n      \r\n      setActiveSession(active || null);\r\n    } catch (err) {\r\n      console.error('Error fetching active session:', err);\r\n      setActiveSession(null);\r\n    } finally {\r\n      setSessionsLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchAttendanceSummary = async () => {\r\n    try {\r\n      setSummaryLoading(true);\r\n\r\n      // Get attendance records\r\n      const { data: records } = await supabase\r\n        .from('attendance')\r\n        .select('id')\r\n        .eq('student_id', currentUser.id);\r\n\r\n      // Get all sessions\r\n      const { data: sessions } = await supabase\r\n        .from('sessions')\r\n        .select('id');\r\n\r\n      const totalAttended = (records || []).length;\r\n      const totalSessions = (sessions || []).length;\r\n      const percentage = totalSessions > 0 \r\n        ? Math.round((totalAttended / totalSessions) * 100) \r\n        : 0;\r\n\r\n      setAttendanceSummary({\r\n        totalAttended,\r\n        totalSessions,\r\n        percentage\r\n      });\r\n    } catch (err) {\r\n      console.error('Error fetching summary:', err);\r\n    } finally {\r\n      setSummaryLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchCourseAttendance = async () => {\r\n    try {\r\n      setCourseLoading(true);\r\n\r\n      const { data: records } = await supabase\r\n        .from('attendance')\r\n        .select(`\r\n          id,\r\n          sessions (\r\n            classes (\r\n              courses (\r\n                id,\r\n                course_code,\r\n                course_title\r\n              )\r\n            )\r\n          )\r\n        `)\r\n        .eq('student_id', currentUser.id);\r\n\r\n      // Group by course and count\r\n      const courseMap = {};\r\n      (records || []).forEach(record => {\r\n        const course = record.sessions?.classes?.courses;\r\n        if (course && !courseMap[course.id]) {\r\n          courseMap[course.id] = {\r\n            id: course.id,\r\n            code: course.course_code,\r\n            title: course.course_title,\r\n            attended: 0\r\n          };\r\n        }\r\n        if (course) {\r\n          courseMap[course.id].attended++;\r\n        }\r\n      });\r\n\r\n      // Get total sessions per course\r\n      const { data: allSessions } = await supabase\r\n        .from('sessions')\r\n        .select(`\r\n          id,\r\n          classes (\r\n            courses (id)\r\n          )\r\n        `);\r\n\r\n      Object.values(courseMap).forEach(course => {\r\n        const total = (allSessions || []).filter(\r\n          s => s.classes?.courses?.id === course.id\r\n        ).length;\r\n        course.total = total || course.attended;\r\n        course.percentage = course.total > 0 \r\n          ? Math.round((course.attended / course.total) * 100)\r\n          : 0;\r\n        course.eligible = course.percentage >= 75;\r\n      });\r\n\r\n      setCourseAttendance(Object.values(courseMap));\r\n    } catch (err) {\r\n      console.error('Error fetching course attendance:', err);\r\n    } finally {\r\n      setCourseLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleMarkAttendance = async () => {\r\n    if (!activeSession) {\r\n      setError('No active session to mark');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setMarking(true);\r\n      setError(null);\r\n\r\n      // Validate session time\r\n      const now = new Date();\r\n      const [startHour, startMin] = activeSession.start_time.split(':');\r\n      const [endHour, endMin] = activeSession.end_time.split(':');\r\n\r\n      const startTime = new Date();\r\n      startTime.setHours(parseInt(startHour), parseInt(startMin), 0);\r\n\r\n      const endTime = new Date();\r\n      endTime.setHours(parseInt(endHour), parseInt(endMin), 59);\r\n\r\n      if (now < startTime || now > endTime) {\r\n        setError('Attendance can only be marked during the session time window');\r\n        return;\r\n      }\r\n\r\n      // Check for existing attendance\r\n      const { data: existing } = await supabase\r\n        .from('attendance')\r\n        .select('id')\r\n        .eq('session_id', activeSession.id)\r\n        .eq('student_id', currentUser.id)\r\n        .single();\r\n\r\n      if (existing) {\r\n        setError('You have already marked attendance for this session');\r\n        return;\r\n      }\r\n\r\n      // Insert attendance\r\n      const { error: insertError } = await supabase\r\n        .from('attendance')\r\n        .insert({\r\n          session_id: activeSession.id,\r\n          student_id: currentUser.id,\r\n          created_at: new Date().toISOString()\r\n        });\r\n\r\n      if (insertError) throw insertError;\r\n\r\n      setSuccess('Attendance marked successfully');\r\n      setActiveSession(null);\r\n      fetchActiveSession();\r\n      fetchAttendanceSummary();\r\n      fetchCourseAttendance();\r\n\r\n      setTimeout(() => setSuccess(null), 3000);\r\n    } catch (err) {\r\n      console.error('Error marking attendance:', err);\r\n      setError(err.message);\r\n    } finally {\r\n      setMarking(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-screen bg-gray-50\">\r\n        <div className=\"text-center\">\r\n          <div className=\"inline-block animate-spin rounded-full h-12 w-12 border border-gray-300 border-t-black mb-4\" />\r\n          <p className=\"text-gray-600\">Loading...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!currentUser || userRole !== 'student') {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Layout role=\"student\">\r\n      <div className=\"min-h-screen bg-gray-50\">\r\n        <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n          \r\n          {/* Alerts */}\r\n          {error && (\r\n            <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded text-red-800 text-sm\">\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          {success && (\r\n            <div className=\"mb-6 p-4 bg-green-50 border border-green-200 rounded text-green-800 text-sm\">\r\n              {success}\r\n            </div>\r\n          )}\r\n\r\n          {/* PAGE TITLE */}\r\n          <h1 className=\"text-3xl font-medium text-gray-900 mb-8\">Dashboard</h1>\r\n\r\n          {/* ===== SECTION 1: MARK ATTENDANCE ===== */}\r\n          <div className=\"mb-8\">\r\n            {sessionsLoading ? (\r\n              <div className=\"bg-white border border-gray-200 rounded p-8 text-center\">\r\n                <p className=\"text-gray-600\">Loading session data...</p>\r\n              </div>\r\n            ) : activeSession ? (\r\n              <div className=\"bg-white border border-gray-200 rounded shadow-sm\">\r\n                <div className=\"border-b border-gray-200 px-6 py-4\">\r\n                  <h2 className=\"text-lg font-medium text-gray-900\">Mark Attendance</h2>\r\n                </div>\r\n                \r\n                <div className=\"px-6 py-6\">\r\n                  {/* Session Information */}\r\n                  <div className=\"mb-6 space-y-4\">\r\n                    <div>\r\n                      <p className=\"text-sm text-gray-600 font-medium uppercase tracking-wide\">Course</p>\r\n                      <p className=\"text-xl text-gray-900 mt-1\">\r\n                        {activeSession.classes.courses.course_code} - {activeSession.classes.courses.course_title}\r\n                      </p>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-6\">\r\n                      <div>\r\n                        <p className=\"text-sm text-gray-600 font-medium uppercase tracking-wide\">Session Date</p>\r\n                        <p className=\"text-base text-gray-900 mt-1\">{activeSession.session_date}</p>\r\n                      </div>\r\n                      <div>\r\n                        <p className=\"text-sm text-gray-600 font-medium uppercase tracking-wide\">Session Time</p>\r\n                        <p className=\"text-base text-gray-900 mt-1\">\r\n                          {activeSession.start_time} – {activeSession.end_time}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {activeSession.classes.users && (\r\n                      <div>\r\n                        <p className=\"text-sm text-gray-600 font-medium uppercase tracking-wide\">Instructor</p>\r\n                        <p className=\"text-base text-gray-900 mt-1\">{activeSession.classes.users.name}</p>\r\n                      </div>\r\n                    )}\r\n\r\n                    {timeRemaining && (\r\n                      <div className=\"pt-4 border-t border-gray-200\">\r\n                        <p className=\"text-sm text-gray-600 font-medium uppercase tracking-wide\">Time Remaining</p>\r\n                        <p className=\"text-base text-black font-medium mt-1\">{timeRemaining}</p>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Button */}\r\n                  <button\r\n                    onClick={handleMarkAttendance}\r\n                    disabled={marking}\r\n                    className=\"w-full px-6 py-3 bg-black text-white font-medium rounded hover:bg-gray-800 disabled:bg-gray-400 transition-colors\"\r\n                  >\r\n                    {marking ? 'Marking...' : 'Mark Attendance'}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div className=\"bg-white border border-gray-200 rounded shadow-sm p-8 text-center\">\r\n                <p className=\"text-gray-600\">There are no active sessions at the moment.</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* ===== SECTION 2: ATTENDANCE SUMMARY ===== */}\r\n          {!summaryLoading && (\r\n            <div className=\"mb-8\">\r\n              <div className=\"bg-white border border-gray-200 rounded shadow-sm\">\r\n                <div className=\"border-b border-gray-200 px-6 py-4\">\r\n                  <h2 className=\"text-lg font-medium text-gray-900\">Attendance Summary</h2>\r\n                </div>\r\n\r\n                <div className=\"px-6 py-6\">\r\n                  <div className=\"grid grid-cols-3 gap-6\">\r\n                    {/* Sessions Attended */}\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-sm text-gray-600 font-medium uppercase tracking-wide\">Sessions Attended</p>\r\n                      <p className=\"text-3xl font-medium text-gray-900 mt-2\">{attendanceSummary.totalAttended}</p>\r\n                    </div>\r\n\r\n                    {/* Total Sessions */}\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-sm text-gray-600 font-medium uppercase tracking-wide\">Total Sessions</p>\r\n                      <p className=\"text-3xl font-medium text-gray-900 mt-2\">{attendanceSummary.totalSessions}</p>\r\n                    </div>\r\n\r\n                    {/* Percentage */}\r\n                    <div className=\"text-center\">\r\n                      <p className=\"text-sm text-gray-600 font-medium uppercase tracking-wide\">Attendance Rate</p>\r\n                      <p className=\"text-3xl font-medium text-gray-900 mt-2\">{attendanceSummary.percentage}%</p>\r\n                      <div className=\"mt-3 w-full bg-gray-200 rounded-full h-2\">\r\n                        <div\r\n                          className={`h-2 rounded-full transition-all ${\r\n                            attendanceSummary.percentage >= 75 ? 'bg-green-600' : 'bg-amber-600'\r\n                          }`}\r\n                          style={{ width: `${Math.min(attendanceSummary.percentage, 100)}%` }}\r\n                        ></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* ===== SECTION 3: COURSE ATTENDANCE ===== */}\r\n          {!courseLoading && courseAttendance.length > 0 && (\r\n            <div className=\"mb-8\">\r\n              <div className=\"bg-white border border-gray-200 rounded shadow-sm\">\r\n                <div className=\"border-b border-gray-200 px-6 py-4\">\r\n                  <h2 className=\"text-lg font-medium text-gray-900\">Course Attendance</h2>\r\n                </div>\r\n\r\n                <div className=\"divide-y divide-gray-200\">\r\n                  {courseAttendance.map((course) => (\r\n                    <div key={course.id} className=\"px-6 py-6\">\r\n                      <div className=\"flex justify-between items-start mb-4\">\r\n                        <div className=\"flex-1\">\r\n                          <h3 className=\"text-base font-medium text-gray-900\">\r\n                            {course.code}\r\n                          </h3>\r\n                          <p className=\"text-sm text-gray-600 mt-1\">{course.title}</p>\r\n                        </div>\r\n                        <span className={`text-sm font-medium ${\r\n                          course.eligible ? 'text-green-700' : 'text-amber-700'\r\n                        }`}>\r\n                          {course.eligible ? 'ELIGIBLE' : 'AT RISK'}\r\n                        </span>\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center justify-between mb-3\">\r\n                        <p className=\"text-sm text-gray-600\">{course.attended} of {course.total} sessions</p>\r\n                        <p className=\"text-sm font-medium text-gray-900\">{course.percentage}%</p>\r\n                      </div>\r\n\r\n                      <div className=\"w-full bg-gray-200 rounded-full h-2 mb-4\">\r\n                        <div\r\n                          className={`h-2 rounded-full transition-all ${\r\n                            course.eligible ? 'bg-green-600' : 'bg-amber-600'\r\n                          }`}\r\n                          style={{ width: `${Math.min(course.percentage, 100)}%` }}\r\n                        ></div>\r\n                      </div>\r\n\r\n                      <button\r\n                        onClick={() => navigate(`/student/history?course=${course.id}`)}\r\n                        className=\"text-sm text-black font-medium hover:text-gray-700\"\r\n                      >\r\n                        View Details →\r\n                      </button>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Empty State */}\r\n          {!courseLoading && courseAttendance.length === 0 && (\r\n            <div className=\"bg-white border border-gray-200 rounded shadow-sm p-8 text-center\">\r\n              <p className=\"text-gray-600\">No attendance records yet.</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default StudentDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}