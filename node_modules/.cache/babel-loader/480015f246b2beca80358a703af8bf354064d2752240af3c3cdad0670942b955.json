{"ast":null,"code":"/**\r\n * Excel Export Utility\r\n * Handles generation and download of Excel files with attendance data\r\n */\n\n/**\r\n * Generate CSV content from attendance data\r\n * CSV format for Excel compatibility\r\n */\nexport const generateAttendanceCSV = (data, filename = 'attendance.csv') => {\n  if (!data || data.length === 0) {\n    console.warn('No data to export');\n    return;\n  }\n\n  // Define CSV headers\n  const headers = ['Student Name', 'Student ID', 'Course Code', 'Course Name', 'Class', 'Session Date', 'Session Time', 'Status'];\n\n  // Convert data rows\n  const rows = data.map(row => [escapeCSV(row.studentName || ''), escapeCSV(row.studentId || ''), escapeCSV(row.course || ''), escapeCSV(row.courseName || ''), escapeCSV(row.class || ''), escapeCSV(row.sessionDate || ''), escapeCSV(row.sessionTime || ''), escapeCSV(row.status || '')]);\n\n  // Combine headers and rows\n  const csvContent = [headers.join(','), ...rows.map(row => row.join(','))].join('\\n');\n\n  // Create blob and download\n  downloadFile(csvContent, filename, 'text/csv;charset=utf-8;');\n};\n\n/**\r\n * Generate Excel-style TSV (Tab-Separated Values)\r\n * Better compatibility with Excel\r\n */\nexport const generateAttendanceTSV = (data, filename = 'attendance.xlsx') => {\n  if (!data || data.length === 0) {\n    console.warn('No data to export');\n    return;\n  }\n\n  // Define headers\n  const headers = ['Student Name', 'Student ID', 'Course Code', 'Course Name', 'Class', 'Session Date', 'Session Time', 'Status'];\n\n  // Convert data rows\n  const rows = data.map(row => [row.studentName || '', row.studentId || '', row.course || '', row.courseName || '', row.class || '', row.sessionDate || '', row.sessionTime || '', row.status || '']);\n\n  // Combine with tabs\n  const tsvContent = [headers.join('\\t'), ...rows.map(row => row.join('\\t'))].join('\\n');\n\n  // Download with .xlsx extension (Excel recognizes TSV)\n  downloadFile(tsvContent, filename, 'application/vnd.ms-excel;charset=utf-8;');\n};\n\n/**\r\n * Generate HTML table and open in new window for Excel copy/paste\r\n * Useful as fallback if file download restricted\r\n */\nexport const exportToHTML = (data, filename = 'attendance') => {\n  if (!data || data.length === 0) {\n    console.warn('No data to export');\n    return;\n  }\n  const headers = ['Student Name', 'Student ID', 'Course Code', 'Course Name', 'Class', 'Session Date', 'Session Time', 'Status'];\n  let html = `\n    <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <style>\n          body { font-family: Arial, sans-serif; margin: 20px; }\n          table { border-collapse: collapse; width: 100%; }\n          th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }\n          th { background-color: #4CAF50; color: white; font-weight: bold; }\n          tr:nth-child(even) { background-color: #f2f2f2; }\n          tr:hover { background-color: #ddd; }\n          h1 { color: #333; }\n        </style>\n      </head>\n      <body>\n        <h1>Attendance Report</h1>\n        <p>Generated: ${new Date().toLocaleString()}</p>\n        <table>\n          <thead>\n            <tr>\n              ${headers.map(h => `<th>${h}</th>`).join('')}\n            </tr>\n          </thead>\n          <tbody>\n            ${data.map(row => `\n              <tr>\n                <td>${row.studentName || ''}</td>\n                <td>${row.studentId || ''}</td>\n                <td>${row.course || ''}</td>\n                <td>${row.courseName || ''}</td>\n                <td>${row.class || ''}</td>\n                <td>${row.sessionDate || ''}</td>\n                <td>${row.sessionTime || ''}</td>\n                <td style=\"font-weight: bold; color: ${row.status === 'Present' ? '#4CAF50' : '#f44336'};\">\n                  ${row.status || ''}\n                </td>\n              </tr>\n            `).join('')}\n          </tbody>\n        </table>\n      </body>\n    </html>\n  `;\n  const newWindow = window.open();\n  newWindow.document.write(html);\n  newWindow.document.title = `${filename} - Attendance Report`;\n};\n\n/**\r\n * Generate summary statistics report\r\n */\nexport const generateSummaryReport = (data, filename = 'attendance_summary.csv') => {\n  if (!data || data.length === 0) {\n    console.warn('No data to export');\n    return;\n  }\n\n  // Calculate statistics\n  const courseStats = {};\n  const studentStats = {};\n  data.forEach(row => {\n    // Course statistics\n    const courseKey = `${row.course} - ${row.courseName}`;\n    if (!courseStats[courseKey]) {\n      courseStats[courseKey] = {\n        course: row.course,\n        courseName: row.courseName,\n        totalSessions: 0,\n        presentCount: 0,\n        absentCount: 0,\n        percentage: 0\n      };\n    }\n    courseStats[courseKey].totalSessions++;\n    if (row.status === 'Present') {\n      courseStats[courseKey].presentCount++;\n    } else {\n      courseStats[courseKey].absentCount++;\n    }\n\n    // Student statistics\n    const studentKey = `${row.studentName} (${row.studentId})`;\n    if (!studentStats[studentKey]) {\n      studentStats[studentKey] = {\n        studentName: row.studentName,\n        studentId: row.studentId,\n        totalSessions: 0,\n        presentCount: 0,\n        absentCount: 0,\n        overallPercentage: 0\n      };\n    }\n    studentStats[studentKey].totalSessions++;\n    if (row.status === 'Present') {\n      studentStats[studentKey].presentCount++;\n    } else {\n      studentStats[studentKey].absentCount++;\n    }\n  });\n\n  // Calculate percentages\n  Object.values(courseStats).forEach(stat => {\n    stat.percentage = stat.totalSessions > 0 ? Math.round(stat.presentCount / stat.totalSessions * 100) : 0;\n  });\n  Object.values(studentStats).forEach(stat => {\n    stat.overallPercentage = stat.totalSessions > 0 ? Math.round(stat.presentCount / stat.totalSessions * 100) : 0;\n  });\n\n  // Create CSV content\n  let csvContent = 'ATTENDANCE SUMMARY REPORT\\n';\n  csvContent += `Generated: ${new Date().toLocaleString()}\\n\\n`;\n  csvContent += 'COURSE STATISTICS\\n';\n  csvContent += 'Course Code,Course Name,Total Sessions,Present,Absent,Attendance %\\n';\n  Object.values(courseStats).forEach(stat => {\n    csvContent += `${stat.course},${stat.courseName},${stat.totalSessions},${stat.presentCount},${stat.absentCount},${stat.percentage}%\\n`;\n  });\n  csvContent += '\\n\\nSTUDENT STATISTICS\\n';\n  csvContent += 'Student Name,Student ID,Total Sessions,Present,Absent,Overall Attendance %\\n';\n  Object.values(studentStats).forEach(stat => {\n    csvContent += `${stat.studentName},${stat.studentId},${stat.totalSessions},${stat.presentCount},${stat.absentCount},${stat.overallPercentage}%\\n`;\n  });\n  downloadFile(csvContent, filename, 'text/csv;charset=utf-8;');\n};\n\n/**\r\n * Helper function to escape CSV values\r\n */\nfunction escapeCSV(value) {\n  if (value === null || value === undefined) return '';\n  const stringValue = String(value);\n  if (stringValue.includes(',') || stringValue.includes('\"') || stringValue.includes('\\n')) {\n    return `\"${stringValue.replace(/\"/g, '\"\"')}\"`;\n  }\n  return stringValue;\n}\n\n/**\r\n * Helper function to download file\r\n */\nfunction downloadFile(content, filename, mimeType) {\n  const blob = new Blob([content], {\n    type: mimeType\n  });\n  const link = document.createElement('a');\n  const url = URL.createObjectURL(blob);\n  link.setAttribute('href', url);\n  link.setAttribute('download', filename);\n  link.style.visibility = 'hidden';\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  URL.revokeObjectURL(url);\n}\n\n/**\r\n * Format date string for use in filenames\r\n */\nexport const getFormattedDateForFilename = () => {\n  const now = new Date();\n  const year = now.getFullYear();\n  const month = String(now.getMonth() + 1).padStart(2, '0');\n  const day = String(now.getDate()).padStart(2, '0');\n  const hours = String(now.getHours()).padStart(2, '0');\n  const minutes = String(now.getMinutes()).padStart(2, '0');\n  return `${year}-${month}-${day}_${hours}${minutes}`;\n};\n\n/**\r\n * Validate date range\r\n */\nexport const isValidDateRange = (startDate, endDate) => {\n  if (!startDate || !endDate) return false;\n  const start = new Date(startDate);\n  const end = new Date(endDate);\n  return start <= end;\n};","map":{"version":3,"names":["generateAttendanceCSV","data","filename","length","console","warn","headers","rows","map","row","escapeCSV","studentName","studentId","course","courseName","class","sessionDate","sessionTime","status","csvContent","join","downloadFile","generateAttendanceTSV","tsvContent","exportToHTML","html","Date","toLocaleString","h","newWindow","window","open","document","write","title","generateSummaryReport","courseStats","studentStats","forEach","courseKey","totalSessions","presentCount","absentCount","percentage","studentKey","overallPercentage","Object","values","stat","Math","round","value","undefined","stringValue","String","includes","replace","content","mimeType","blob","Blob","type","link","createElement","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild","revokeObjectURL","getFormattedDateForFilename","now","year","getFullYear","month","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","isValidDateRange","startDate","endDate","start","end"],"sources":["C:/Users/PFI/Desktop/ictuattennce_portal/ATTENDANCE/src/utils/excelExport.js"],"sourcesContent":["/**\r\n * Excel Export Utility\r\n * Handles generation and download of Excel files with attendance data\r\n */\r\n\r\n/**\r\n * Generate CSV content from attendance data\r\n * CSV format for Excel compatibility\r\n */\r\nexport const generateAttendanceCSV = (data, filename = 'attendance.csv') => {\r\n  if (!data || data.length === 0) {\r\n    console.warn('No data to export');\r\n    return;\r\n  }\r\n\r\n  // Define CSV headers\r\n  const headers = [\r\n    'Student Name',\r\n    'Student ID',\r\n    'Course Code',\r\n    'Course Name',\r\n    'Class',\r\n    'Session Date',\r\n    'Session Time',\r\n    'Status'\r\n  ];\r\n\r\n  // Convert data rows\r\n  const rows = data.map(row => [\r\n    escapeCSV(row.studentName || ''),\r\n    escapeCSV(row.studentId || ''),\r\n    escapeCSV(row.course || ''),\r\n    escapeCSV(row.courseName || ''),\r\n    escapeCSV(row.class || ''),\r\n    escapeCSV(row.sessionDate || ''),\r\n    escapeCSV(row.sessionTime || ''),\r\n    escapeCSV(row.status || '')\r\n  ]);\r\n\r\n  // Combine headers and rows\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...rows.map(row => row.join(','))\r\n  ].join('\\n');\r\n\r\n  // Create blob and download\r\n  downloadFile(csvContent, filename, 'text/csv;charset=utf-8;');\r\n};\r\n\r\n/**\r\n * Generate Excel-style TSV (Tab-Separated Values)\r\n * Better compatibility with Excel\r\n */\r\nexport const generateAttendanceTSV = (data, filename = 'attendance.xlsx') => {\r\n  if (!data || data.length === 0) {\r\n    console.warn('No data to export');\r\n    return;\r\n  }\r\n\r\n  // Define headers\r\n  const headers = [\r\n    'Student Name',\r\n    'Student ID',\r\n    'Course Code',\r\n    'Course Name',\r\n    'Class',\r\n    'Session Date',\r\n    'Session Time',\r\n    'Status'\r\n  ];\r\n\r\n  // Convert data rows\r\n  const rows = data.map(row => [\r\n    row.studentName || '',\r\n    row.studentId || '',\r\n    row.course || '',\r\n    row.courseName || '',\r\n    row.class || '',\r\n    row.sessionDate || '',\r\n    row.sessionTime || '',\r\n    row.status || ''\r\n  ]);\r\n\r\n  // Combine with tabs\r\n  const tsvContent = [\r\n    headers.join('\\t'),\r\n    ...rows.map(row => row.join('\\t'))\r\n  ].join('\\n');\r\n\r\n  // Download with .xlsx extension (Excel recognizes TSV)\r\n  downloadFile(tsvContent, filename, 'application/vnd.ms-excel;charset=utf-8;');\r\n};\r\n\r\n/**\r\n * Generate HTML table and open in new window for Excel copy/paste\r\n * Useful as fallback if file download restricted\r\n */\r\nexport const exportToHTML = (data, filename = 'attendance') => {\r\n  if (!data || data.length === 0) {\r\n    console.warn('No data to export');\r\n    return;\r\n  }\r\n\r\n  const headers = [\r\n    'Student Name',\r\n    'Student ID',\r\n    'Course Code',\r\n    'Course Name',\r\n    'Class',\r\n    'Session Date',\r\n    'Session Time',\r\n    'Status'\r\n  ];\r\n\r\n  let html = `\r\n    <html>\r\n      <head>\r\n        <meta charset=\"UTF-8\">\r\n        <style>\r\n          body { font-family: Arial, sans-serif; margin: 20px; }\r\n          table { border-collapse: collapse; width: 100%; }\r\n          th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }\r\n          th { background-color: #4CAF50; color: white; font-weight: bold; }\r\n          tr:nth-child(even) { background-color: #f2f2f2; }\r\n          tr:hover { background-color: #ddd; }\r\n          h1 { color: #333; }\r\n        </style>\r\n      </head>\r\n      <body>\r\n        <h1>Attendance Report</h1>\r\n        <p>Generated: ${new Date().toLocaleString()}</p>\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              ${headers.map(h => `<th>${h}</th>`).join('')}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            ${data.map(row => `\r\n              <tr>\r\n                <td>${row.studentName || ''}</td>\r\n                <td>${row.studentId || ''}</td>\r\n                <td>${row.course || ''}</td>\r\n                <td>${row.courseName || ''}</td>\r\n                <td>${row.class || ''}</td>\r\n                <td>${row.sessionDate || ''}</td>\r\n                <td>${row.sessionTime || ''}</td>\r\n                <td style=\"font-weight: bold; color: ${row.status === 'Present' ? '#4CAF50' : '#f44336'};\">\r\n                  ${row.status || ''}\r\n                </td>\r\n              </tr>\r\n            `).join('')}\r\n          </tbody>\r\n        </table>\r\n      </body>\r\n    </html>\r\n  `;\r\n\r\n  const newWindow = window.open();\r\n  newWindow.document.write(html);\r\n  newWindow.document.title = `${filename} - Attendance Report`;\r\n};\r\n\r\n/**\r\n * Generate summary statistics report\r\n */\r\nexport const generateSummaryReport = (data, filename = 'attendance_summary.csv') => {\r\n  if (!data || data.length === 0) {\r\n    console.warn('No data to export');\r\n    return;\r\n  }\r\n\r\n  // Calculate statistics\r\n  const courseStats = {};\r\n  const studentStats = {};\r\n\r\n  data.forEach(row => {\r\n    // Course statistics\r\n    const courseKey = `${row.course} - ${row.courseName}`;\r\n    if (!courseStats[courseKey]) {\r\n      courseStats[courseKey] = {\r\n        course: row.course,\r\n        courseName: row.courseName,\r\n        totalSessions: 0,\r\n        presentCount: 0,\r\n        absentCount: 0,\r\n        percentage: 0\r\n      };\r\n    }\r\n    courseStats[courseKey].totalSessions++;\r\n    if (row.status === 'Present') {\r\n      courseStats[courseKey].presentCount++;\r\n    } else {\r\n      courseStats[courseKey].absentCount++;\r\n    }\r\n\r\n    // Student statistics\r\n    const studentKey = `${row.studentName} (${row.studentId})`;\r\n    if (!studentStats[studentKey]) {\r\n      studentStats[studentKey] = {\r\n        studentName: row.studentName,\r\n        studentId: row.studentId,\r\n        totalSessions: 0,\r\n        presentCount: 0,\r\n        absentCount: 0,\r\n        overallPercentage: 0\r\n      };\r\n    }\r\n    studentStats[studentKey].totalSessions++;\r\n    if (row.status === 'Present') {\r\n      studentStats[studentKey].presentCount++;\r\n    } else {\r\n      studentStats[studentKey].absentCount++;\r\n    }\r\n  });\r\n\r\n  // Calculate percentages\r\n  Object.values(courseStats).forEach(stat => {\r\n    stat.percentage = stat.totalSessions > 0 \r\n      ? Math.round((stat.presentCount / stat.totalSessions) * 100)\r\n      : 0;\r\n  });\r\n\r\n  Object.values(studentStats).forEach(stat => {\r\n    stat.overallPercentage = stat.totalSessions > 0\r\n      ? Math.round((stat.presentCount / stat.totalSessions) * 100)\r\n      : 0;\r\n  });\r\n\r\n  // Create CSV content\r\n  let csvContent = 'ATTENDANCE SUMMARY REPORT\\n';\r\n  csvContent += `Generated: ${new Date().toLocaleString()}\\n\\n`;\r\n\r\n  csvContent += 'COURSE STATISTICS\\n';\r\n  csvContent += 'Course Code,Course Name,Total Sessions,Present,Absent,Attendance %\\n';\r\n  Object.values(courseStats).forEach(stat => {\r\n    csvContent += `${stat.course},${stat.courseName},${stat.totalSessions},${stat.presentCount},${stat.absentCount},${stat.percentage}%\\n`;\r\n  });\r\n\r\n  csvContent += '\\n\\nSTUDENT STATISTICS\\n';\r\n  csvContent += 'Student Name,Student ID,Total Sessions,Present,Absent,Overall Attendance %\\n';\r\n  Object.values(studentStats).forEach(stat => {\r\n    csvContent += `${stat.studentName},${stat.studentId},${stat.totalSessions},${stat.presentCount},${stat.absentCount},${stat.overallPercentage}%\\n`;\r\n  });\r\n\r\n  downloadFile(csvContent, filename, 'text/csv;charset=utf-8;');\r\n};\r\n\r\n/**\r\n * Helper function to escape CSV values\r\n */\r\nfunction escapeCSV(value) {\r\n  if (value === null || value === undefined) return '';\r\n  const stringValue = String(value);\r\n  if (stringValue.includes(',') || stringValue.includes('\"') || stringValue.includes('\\n')) {\r\n    return `\"${stringValue.replace(/\"/g, '\"\"')}\"`;\r\n  }\r\n  return stringValue;\r\n}\r\n\r\n/**\r\n * Helper function to download file\r\n */\r\nfunction downloadFile(content, filename, mimeType) {\r\n  const blob = new Blob([content], { type: mimeType });\r\n  const link = document.createElement('a');\r\n  const url = URL.createObjectURL(blob);\r\n\r\n  link.setAttribute('href', url);\r\n  link.setAttribute('download', filename);\r\n  link.style.visibility = 'hidden';\r\n\r\n  document.body.appendChild(link);\r\n  link.click();\r\n\r\n  document.body.removeChild(link);\r\n  URL.revokeObjectURL(url);\r\n}\r\n\r\n/**\r\n * Format date string for use in filenames\r\n */\r\nexport const getFormattedDateForFilename = () => {\r\n  const now = new Date();\r\n  const year = now.getFullYear();\r\n  const month = String(now.getMonth() + 1).padStart(2, '0');\r\n  const day = String(now.getDate()).padStart(2, '0');\r\n  const hours = String(now.getHours()).padStart(2, '0');\r\n  const minutes = String(now.getMinutes()).padStart(2, '0');\r\n  \r\n  return `${year}-${month}-${day}_${hours}${minutes}`;\r\n};\r\n\r\n/**\r\n * Validate date range\r\n */\r\nexport const isValidDateRange = (startDate, endDate) => {\r\n  if (!startDate || !endDate) return false;\r\n  const start = new Date(startDate);\r\n  const end = new Date(endDate);\r\n  return start <= end;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}