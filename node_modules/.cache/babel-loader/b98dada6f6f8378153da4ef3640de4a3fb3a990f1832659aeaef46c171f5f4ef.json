{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\PFI\\\\Desktop\\\\ATTENDANCE\\\\ATTENDANCE\\\\src\\\\pages\\\\StudentDashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { supabase } from '../supabase/supabase';\nimport { useAuth } from '../contexts/AuthContext';\nimport { calculateHaversineDistance } from '../utils/gpsUtils';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst StudentDashboard = () => {\n  _s();\n  const {\n    currentUser,\n    logout,\n    userRole,\n    loading\n  } = useAuth();\n  const navigate = useNavigate();\n\n  // Protect route - only allow students\n  useEffect(() => {\n    if (!loading) {\n      if (!currentUser) {\n        navigate('/student');\n        return;\n      }\n      if (userRole && userRole !== 'student') {\n        navigate('/student');\n        return;\n      }\n    }\n  }, [currentUser, userRole, loading, navigate]);\n  const [message, setMessage] = useState('');\n  const [messageType, setMessageType] = useState('');\n  const [gpsStatus, setGpsStatus] = useState('disabled');\n  const [gpsData, setGpsData] = useState(null);\n  const [distance, setDistance] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [courses, setCourses] = useState([]);\n  const [selectedCourse, setSelectedCourse] = useState('');\n  const CAMPUS_LAT = 3.8621;\n  const CAMPUS_LON = 11.5021;\n  const GEOFENCE_RADIUS = 200;\n  const MAX_GPS_ACCURACY = 50;\n  useEffect(() => {\n    // Defer GPS and course loading to avoid blocking initial render\n    // Only fetch if user is authenticated and on student dashboard\n    if (currentUser && userRole === 'student') {\n      requestGPSPermission();\n      fetchCourses();\n    }\n  }, [currentUser, userRole]);\n  const fetchCourses = async () => {\n    try {\n      const {\n        data,\n        error\n      } = await supabase.from('classes').select('id, class_name').limit(10);\n      if (error) throw error;\n      setCourses(data || []);\n    } catch (err) {\n      console.error('Error fetching courses:', err);\n    }\n  };\n  const requestGPSPermission = () => {\n    if (!navigator.geolocation) {\n      setGpsStatus('error');\n      setMessage('‚ùå Geolocation is not supported by this device');\n      setMessageType('error');\n      return;\n    }\n    setGpsStatus('acquiring');\n    setMessage('üìç Acquiring GPS location...');\n    setMessageType('info');\n    let timeoutId;\n    const watchId = navigator.geolocation.watchPosition(position => {\n      // Clear timeout once we get a position\n      if (timeoutId) clearTimeout(timeoutId);\n      const {\n        latitude,\n        longitude,\n        accuracy\n      } = position.coords;\n      setGpsData({\n        latitude,\n        longitude,\n        accuracy\n      });\n      const dist = calculateHaversineDistance(latitude, longitude, CAMPUS_LAT, CAMPUS_LON);\n      setDistance(dist);\n      if (accuracy <= MAX_GPS_ACCURACY && dist <= GEOFENCE_RADIUS) {\n        setGpsStatus('ready');\n        setMessage(`‚úÖ GPS Ready | Distance: ${dist.toFixed(0)}m | Accuracy: ${accuracy.toFixed(0)}m`);\n        setMessageType('info');\n      } else if (accuracy > MAX_GPS_ACCURACY) {\n        setGpsStatus('acquiring');\n        setMessage(`üìç GPS signal weak | Accuracy: ${accuracy.toFixed(0)}m (need ‚â§${MAX_GPS_ACCURACY}m) | Distance: ${dist.toFixed(0)}m`);\n        setMessageType('info');\n      } else if (dist > GEOFENCE_RADIUS) {\n        setGpsStatus('error');\n        setMessage(`‚ùå Outside campus | Distance: ${dist.toFixed(0)}m away (allowed: ‚â§${GEOFENCE_RADIUS}m)`);\n        setMessageType('error');\n      }\n    }, error => {\n      setGpsStatus('error');\n      let errorMsg = '‚ùå GPS Error: ';\n      switch (error.code) {\n        case error.PERMISSION_DENIED:\n          errorMsg += 'Permission denied. Please enable location access.';\n          break;\n        case error.POSITION_UNAVAILABLE:\n          errorMsg += 'Position unavailable. Check GPS settings.';\n          break;\n        case error.TIMEOUT:\n          errorMsg += 'GPS acquisition timeout. Try again.';\n          break;\n        default:\n          errorMsg += 'Unknown GPS error.';\n      }\n      setMessage(errorMsg);\n      setMessageType('error');\n    }, {\n      enableHighAccuracy: true,\n      maximumAge: 0,\n      timeout: 5000 // Reduced from 10s to 5s for faster feedback\n    });\n\n    // Set a manual timeout to stop GPS if it takes too long\n    timeoutId = setTimeout(() => {\n      navigator.geolocation.clearWatch(watchId);\n      setGpsStatus('error');\n      setMessage('‚è±Ô∏è GPS acquisition took too long. Please refresh and try again.');\n      setMessageType('error');\n    }, 8000);\n    return () => navigator.geolocation.clearWatch(watchId);\n  };\n  const markAttendance = async () => {\n    setIsLoading(true);\n    try {\n      if (!gpsData) {\n        setMessage('‚ùå GPS data not available. Please wait...');\n        setMessageType('error');\n        setIsLoading(false);\n        return;\n      }\n      if (gpsData.accuracy > MAX_GPS_ACCURACY) {\n        setMessage(`‚ùå GPS accuracy too low: ${gpsData.accuracy.toFixed(0)}m (required: ‚â§${MAX_GPS_ACCURACY}m). Move to open area.`);\n        setMessageType('error');\n        setIsLoading(false);\n        return;\n      }\n      if (distance > GEOFENCE_RADIUS) {\n        setMessage(`‚ùå Outside campus boundary: ${distance.toFixed(0)}m away (allowed: ‚â§${GEOFENCE_RADIUS}m). Enter campus.`);\n        setMessageType('error');\n        setIsLoading(false);\n        return;\n      }\n      if (!selectedCourse) {\n        setMessage('‚ùå Please select a course');\n        setMessageType('error');\n        setIsLoading(false);\n        return;\n      }\n      setMessage('‚è≥ Processing attendance...');\n      setMessageType('info');\n      const {\n        error\n      } = await supabase.from('attendance').insert({\n        class_id: selectedCourse,\n        student_id: currentUser.id,\n        latitude: gpsData.latitude,\n        longitude: gpsData.longitude,\n        accuracy: gpsData.accuracy,\n        distance_from_campus: distance,\n        gps_validated_at: new Date().toISOString()\n      });\n      if (error) {\n        if (error.code === '23505') {\n          setMessage('‚ö†Ô∏è Attendance already marked for this course today');\n          setMessageType('info');\n        } else {\n          throw error;\n        }\n      } else {\n        setMessage(`‚úÖ Attendance Recorded!\\nüìç Distance: ${distance.toFixed(0)}m\\nüì∂ Accuracy: ${gpsData.accuracy.toFixed(0)}m`);\n        setMessageType('success');\n      }\n    } catch (err) {\n      console.error('Attendance error:', err);\n      setMessage('‚ùå Error recording attendance. Please try again.');\n      setMessageType('error');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleLogout = async () => {\n    try {\n      await logout();\n      navigate('/student');\n    } catch (err) {\n      console.error('Logout error:', err);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inline-block\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mb-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600\",\n          children: \"Loading your profile...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 9\n    }, this), !loading && !currentUser && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-red-600 font-semibold mb-4\",\n          children: \"You must be logged in to access this page.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => navigate('/student'),\n          className: \"px-6 py-2 bg-indigo-600 text-white rounded-lg\",\n          children: \"Go to Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 9\n    }, this), !loading && currentUser && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 p-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-2xl mx-auto\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-6 flex justify-between items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-3xl font-bold text-gray-900\",\n              children: \"Student Dashboard\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-gray-600\",\n              children: \"\\uD83D\\uDCCD GPS-Based Attendance\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 13\n            }, this), currentUser && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-500 mt-1\",\n              children: [\"\\uD83D\\uDC64 \", currentUser.email]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleLogout,\n            className: \"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition\",\n            children: \"Logout\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 9\n        }, this), message && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `rounded-lg p-4 mb-6 text-white whitespace-pre-wrap ${messageType === 'success' ? 'bg-green-500' : messageType === 'error' ? 'bg-red-500' : 'bg-blue-500'}`,\n          children: message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 lg:grid-cols-2 gap-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white rounded-lg shadow-lg p-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-xl font-bold text-gray-900 mb-4\",\n              children: \"\\uD83D\\uDCCD GPS Status\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `rounded-lg p-4 mb-4 text-white text-center font-semibold ${gpsStatus === 'ready' ? 'bg-green-500' : gpsStatus === 'acquiring' ? 'bg-yellow-500' : 'bg-red-500'}`,\n              children: gpsStatus === 'ready' ? '‚úÖ Ready' : gpsStatus === 'acquiring' ? '‚è≥ Acquiring...' : '‚ùå Error'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 13\n            }, this), gpsData && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-sm text-gray-700 space-y-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Latitude:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 290,\n                  columnNumber: 20\n                }, this), \" \", gpsData.latitude.toFixed(6), \"\\xB0\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 290,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Longitude:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 291,\n                  columnNumber: 20\n                }, this), \" \", gpsData.longitude.toFixed(6), \"\\xB0\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 291,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Accuracy:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 293,\n                  columnNumber: 19\n                }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: gpsData.accuracy <= MAX_GPS_ACCURACY ? 'text-green-600' : 'text-red-600',\n                  children: [gpsData.accuracy.toFixed(1), \"m \", gpsData.accuracy <= MAX_GPS_ACCURACY ? '‚úì' : '‚úó']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 293,\n                  columnNumber: 46\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 292,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Distance:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 298,\n                  columnNumber: 19\n                }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: distance <= GEOFENCE_RADIUS ? 'text-green-600' : 'text-red-600',\n                  children: [distance === null || distance === void 0 ? void 0 : distance.toFixed(0), \"m \", distance <= GEOFENCE_RADIUS ? '‚úì' : '‚úó']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 298,\n                  columnNumber: 46\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 289,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-white rounded-lg shadow-lg p-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-xl font-bold text-gray-900 mb-4\",\n              children: \"\\uD83D\\uDCDA Mark Attendance\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"block text-sm font-semibold text-gray-700 mb-2\",\n                  children: \"Select Course\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 311,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  value: selectedCourse,\n                  onChange: e => setSelectedCourse(e.target.value),\n                  disabled: isLoading,\n                  className: \"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100\",\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    children: \"Choose a course...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 320,\n                    columnNumber: 19\n                  }, this), courses.map(course => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: course.id,\n                    children: course.class_name\n                  }, course.id, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 322,\n                    columnNumber: 21\n                  }, this))]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 314,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 310,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: markAttendance,\n                disabled: isLoading || gpsStatus !== 'ready' || !selectedCourse,\n                className: \"w-full bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white font-semibold py-3 rounded-lg transition\",\n                children: isLoading ? '‚è≥ Processing...' : 'üìç Mark Attendance'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 329,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg text-xs text-blue-800\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"font-semibold mb-1\",\n                children: \"Requirements:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 339,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"space-y-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"\\u2713 GPS accuracy \\u2264 50m\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 341,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"\\u2713 Within 200m of campus\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 342,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: \"\\u2713 Course selected\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 343,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 340,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 338,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6 bg-white rounded-lg shadow-lg p-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-bold text-gray-900 mb-3\",\n            children: \"\\uD83D\\uDCCD Campus Information\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-700 mb-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Location:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 13\n            }, this), \" ICT University Yaound\\xE9, Cameroon\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-700 mb-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Coordinates:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 13\n            }, this), \" 3.8621\\xB0N, 11.5021\\xB0E\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-700\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Geofence Radius:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 358,\n              columnNumber: 13\n            }, this), \" 200 meters\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n};\n_s(StudentDashboard, \"17zL94mslhXkhzVN67uoyk8Ni0I=\", false, function () {\n  return [useAuth, useNavigate];\n});\n_c = StudentDashboard;\nexport default StudentDashboard;\nvar _c;\n$RefreshReg$(_c, \"StudentDashboard\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","supabase","useAuth","calculateHaversineDistance","jsxDEV","_jsxDEV","Fragment","_Fragment","StudentDashboard","_s","currentUser","logout","userRole","loading","navigate","message","setMessage","messageType","setMessageType","gpsStatus","setGpsStatus","gpsData","setGpsData","distance","setDistance","isLoading","setIsLoading","courses","setCourses","selectedCourse","setSelectedCourse","CAMPUS_LAT","CAMPUS_LON","GEOFENCE_RADIUS","MAX_GPS_ACCURACY","requestGPSPermission","fetchCourses","data","error","from","select","limit","err","console","navigator","geolocation","timeoutId","watchId","watchPosition","position","clearTimeout","latitude","longitude","accuracy","coords","dist","toFixed","errorMsg","code","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","enableHighAccuracy","maximumAge","timeout","setTimeout","clearWatch","markAttendance","insert","class_id","student_id","id","distance_from_campus","gps_validated_at","Date","toISOString","handleLogout","children","className","fileName","_jsxFileName","lineNumber","columnNumber","onClick","email","value","onChange","e","target","disabled","map","course","class_name","_c","$RefreshReg$"],"sources":["C:/Users/PFI/Desktop/ATTENDANCE/ATTENDANCE/src/pages/StudentDashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { supabase } from '../supabase/supabase';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { calculateHaversineDistance } from '../utils/gpsUtils';\r\n\r\nconst StudentDashboard = () => {\r\n  const { currentUser, logout, userRole, loading } = useAuth();\r\n  const navigate = useNavigate();\r\n  \r\n  // Protect route - only allow students\r\n  useEffect(() => {\r\n    if (!loading) {\r\n      if (!currentUser) {\r\n        navigate('/student');\r\n        return;\r\n      }\r\n      if (userRole && userRole !== 'student') {\r\n        navigate('/student');\r\n        return;\r\n      }\r\n    }\r\n  }, [currentUser, userRole, loading, navigate]);\r\n\r\n  const [message, setMessage] = useState('');\r\n  const [messageType, setMessageType] = useState('');\r\n  const [gpsStatus, setGpsStatus] = useState('disabled');\r\n  const [gpsData, setGpsData] = useState(null);\r\n  const [distance, setDistance] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [courses, setCourses] = useState([]);\r\n  const [selectedCourse, setSelectedCourse] = useState('');\r\n\r\n  const CAMPUS_LAT = 3.8621;\r\n  const CAMPUS_LON = 11.5021;\r\n  const GEOFENCE_RADIUS = 200;\r\n  const MAX_GPS_ACCURACY = 50;\r\n\r\n  useEffect(() => {\r\n    // Defer GPS and course loading to avoid blocking initial render\r\n    // Only fetch if user is authenticated and on student dashboard\r\n    if (currentUser && userRole === 'student') {\r\n      requestGPSPermission();\r\n      fetchCourses();\r\n    }\r\n  }, [currentUser, userRole]);\r\n\r\n  const fetchCourses = async () => {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('classes')\r\n        .select('id, class_name')\r\n        .limit(10);\r\n      if (error) throw error;\r\n      setCourses(data || []);\r\n    } catch (err) {\r\n      console.error('Error fetching courses:', err);\r\n    }\r\n  };\r\n\r\n  const requestGPSPermission = () => {\r\n    if (!navigator.geolocation) {\r\n      setGpsStatus('error');\r\n      setMessage('‚ùå Geolocation is not supported by this device');\r\n      setMessageType('error');\r\n      return;\r\n    }\r\n\r\n    setGpsStatus('acquiring');\r\n    setMessage('üìç Acquiring GPS location...');\r\n    setMessageType('info');\r\n\r\n    let timeoutId;\r\n    const watchId = navigator.geolocation.watchPosition(\r\n      (position) => {\r\n        // Clear timeout once we get a position\r\n        if (timeoutId) clearTimeout(timeoutId);\r\n        \r\n        const { latitude, longitude, accuracy } = position.coords;\r\n        setGpsData({ latitude, longitude, accuracy });\r\n\r\n        const dist = calculateHaversineDistance(latitude, longitude, CAMPUS_LAT, CAMPUS_LON);\r\n        setDistance(dist);\r\n\r\n        if (accuracy <= MAX_GPS_ACCURACY && dist <= GEOFENCE_RADIUS) {\r\n          setGpsStatus('ready');\r\n          setMessage(\r\n            `‚úÖ GPS Ready | Distance: ${dist.toFixed(0)}m | Accuracy: ${accuracy.toFixed(0)}m`\r\n          );\r\n          setMessageType('info');\r\n        } else if (accuracy > MAX_GPS_ACCURACY) {\r\n          setGpsStatus('acquiring');\r\n          setMessage(\r\n            `üìç GPS signal weak | Accuracy: ${accuracy.toFixed(0)}m (need ‚â§${MAX_GPS_ACCURACY}m) | Distance: ${dist.toFixed(0)}m`\r\n          );\r\n          setMessageType('info');\r\n        } else if (dist > GEOFENCE_RADIUS) {\r\n          setGpsStatus('error');\r\n          setMessage(\r\n            `‚ùå Outside campus | Distance: ${dist.toFixed(0)}m away (allowed: ‚â§${GEOFENCE_RADIUS}m)`\r\n          );\r\n          setMessageType('error');\r\n        }\r\n      },\r\n      (error) => {\r\n        setGpsStatus('error');\r\n        let errorMsg = '‚ùå GPS Error: ';\r\n        switch (error.code) {\r\n          case error.PERMISSION_DENIED:\r\n            errorMsg += 'Permission denied. Please enable location access.';\r\n            break;\r\n          case error.POSITION_UNAVAILABLE:\r\n            errorMsg += 'Position unavailable. Check GPS settings.';\r\n            break;\r\n          case error.TIMEOUT:\r\n            errorMsg += 'GPS acquisition timeout. Try again.';\r\n            break;\r\n          default:\r\n            errorMsg += 'Unknown GPS error.';\r\n        }\r\n        setMessage(errorMsg);\r\n        setMessageType('error');\r\n      },\r\n      {\r\n        enableHighAccuracy: true,\r\n        maximumAge: 0,\r\n        timeout: 5000, // Reduced from 10s to 5s for faster feedback\r\n      }\r\n    );\r\n\r\n    // Set a manual timeout to stop GPS if it takes too long\r\n    timeoutId = setTimeout(() => {\r\n      navigator.geolocation.clearWatch(watchId);\r\n      setGpsStatus('error');\r\n      setMessage('‚è±Ô∏è GPS acquisition took too long. Please refresh and try again.');\r\n      setMessageType('error');\r\n    }, 8000);\r\n\r\n    return () => navigator.geolocation.clearWatch(watchId);\r\n  };\r\n\r\n  const markAttendance = async () => {\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      if (!gpsData) {\r\n        setMessage('‚ùå GPS data not available. Please wait...');\r\n        setMessageType('error');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (gpsData.accuracy > MAX_GPS_ACCURACY) {\r\n        setMessage(`‚ùå GPS accuracy too low: ${gpsData.accuracy.toFixed(0)}m (required: ‚â§${MAX_GPS_ACCURACY}m). Move to open area.`);\r\n        setMessageType('error');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (distance > GEOFENCE_RADIUS) {\r\n        setMessage(`‚ùå Outside campus boundary: ${distance.toFixed(0)}m away (allowed: ‚â§${GEOFENCE_RADIUS}m). Enter campus.`);\r\n        setMessageType('error');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (!selectedCourse) {\r\n        setMessage('‚ùå Please select a course');\r\n        setMessageType('error');\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n\r\n      setMessage('‚è≥ Processing attendance...');\r\n      setMessageType('info');\r\n\r\n      const { error } = await supabase.from('attendance').insert({\r\n        class_id: selectedCourse,\r\n        student_id: currentUser.id,\r\n        latitude: gpsData.latitude,\r\n        longitude: gpsData.longitude,\r\n        accuracy: gpsData.accuracy,\r\n        distance_from_campus: distance,\r\n        gps_validated_at: new Date().toISOString(),\r\n      });\r\n\r\n      if (error) {\r\n        if (error.code === '23505') {\r\n          setMessage('‚ö†Ô∏è Attendance already marked for this course today');\r\n          setMessageType('info');\r\n        } else {\r\n          throw error;\r\n        }\r\n      } else {\r\n        setMessage(\r\n          `‚úÖ Attendance Recorded!\\nüìç Distance: ${distance.toFixed(0)}m\\nüì∂ Accuracy: ${gpsData.accuracy.toFixed(0)}m`\r\n        );\r\n        setMessageType('success');\r\n      }\r\n    } catch (err) {\r\n      console.error('Attendance error:', err);\r\n      setMessage('‚ùå Error recording attendance. Please try again.');\r\n      setMessageType('error');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      await logout();\r\n      navigate('/student');\r\n    } catch (err) {\r\n      console.error('Logout error:', err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {loading && (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center\">\r\n          <div className=\"text-center\">\r\n            <div className=\"inline-block\">\r\n              <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mb-4\"></div>\r\n            </div>\r\n            <p className=\"text-gray-600\">Loading your profile...</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {!loading && !currentUser && (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center\">\r\n          <div className=\"text-center\">\r\n            <p className=\"text-red-600 font-semibold mb-4\">You must be logged in to access this page.</p>\r\n            <button onClick={() => navigate('/student')} className=\"px-6 py-2 bg-indigo-600 text-white rounded-lg\">\r\n              Go to Login\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {!loading && currentUser && (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 p-4\">\r\n      <div className=\"max-w-2xl mx-auto\">\r\n        <div className=\"mb-6 flex justify-between items-center\">\r\n          <div>\r\n            <h1 className=\"text-3xl font-bold text-gray-900\">Student Dashboard</h1>\r\n            <p className=\"text-gray-600\">üìç GPS-Based Attendance</p>\r\n            {currentUser && <p className=\"text-sm text-gray-500 mt-1\">üë§ {currentUser.email}</p>}\r\n          </div>\r\n          <button\r\n            onClick={handleLogout}\r\n            className=\"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition\"\r\n          >\r\n            Logout\r\n          </button>\r\n        </div>\r\n\r\n        {message && (\r\n          <div\r\n            className={`rounded-lg p-4 mb-6 text-white whitespace-pre-wrap ${\r\n              messageType === 'success'\r\n                ? 'bg-green-500'\r\n                : messageType === 'error'\r\n                ? 'bg-red-500'\r\n                : 'bg-blue-500'\r\n            }`}\r\n          >\r\n            {message}\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n            <h2 className=\"text-xl font-bold text-gray-900 mb-4\">üìç GPS Status</h2>\r\n            <div\r\n              className={`rounded-lg p-4 mb-4 text-white text-center font-semibold ${\r\n                gpsStatus === 'ready'\r\n                  ? 'bg-green-500'\r\n                  : gpsStatus === 'acquiring'\r\n                  ? 'bg-yellow-500'\r\n                  : 'bg-red-500'\r\n              }`}\r\n            >\r\n              {gpsStatus === 'ready' ? '‚úÖ Ready' : gpsStatus === 'acquiring' ? '‚è≥ Acquiring...' : '‚ùå Error'}\r\n            </div>\r\n\r\n            {gpsData && (\r\n              <div className=\"text-sm text-gray-700 space-y-2\">\r\n                <p><strong>Latitude:</strong> {gpsData.latitude.toFixed(6)}¬∞</p>\r\n                <p><strong>Longitude:</strong> {gpsData.longitude.toFixed(6)}¬∞</p>\r\n                <p>\r\n                  <strong>Accuracy:</strong> <span className={gpsData.accuracy <= MAX_GPS_ACCURACY ? 'text-green-600' : 'text-red-600'}>\r\n                    {gpsData.accuracy.toFixed(1)}m {gpsData.accuracy <= MAX_GPS_ACCURACY ? '‚úì' : '‚úó'}\r\n                  </span>\r\n                </p>\r\n                <p>\r\n                  <strong>Distance:</strong> <span className={distance <= GEOFENCE_RADIUS ? 'text-green-600' : 'text-red-600'}>\r\n                    {distance?.toFixed(0)}m {distance <= GEOFENCE_RADIUS ? '‚úì' : '‚úó'}\r\n                  </span>\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n            <h2 className=\"text-xl font-bold text-gray-900 mb-4\">üìö Mark Attendance</h2>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-semibold text-gray-700 mb-2\">\r\n                  Select Course\r\n                </label>\r\n                <select\r\n                  value={selectedCourse}\r\n                  onChange={(e) => setSelectedCourse(e.target.value)}\r\n                  disabled={isLoading}\r\n                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100\"\r\n                >\r\n                  <option value=\"\">Choose a course...</option>\r\n                  {courses.map((course) => (\r\n                    <option key={course.id} value={course.id}>\r\n                      {course.class_name}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              <button\r\n                onClick={markAttendance}\r\n                disabled={isLoading || gpsStatus !== 'ready' || !selectedCourse}\r\n                className=\"w-full bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white font-semibold py-3 rounded-lg transition\"\r\n              >\r\n                {isLoading ? '‚è≥ Processing...' : 'üìç Mark Attendance'}\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg text-xs text-blue-800\">\r\n              <p className=\"font-semibold mb-1\">Requirements:</p>\r\n              <ul className=\"space-y-1\">\r\n                <li>‚úì GPS accuracy ‚â§ 50m</li>\r\n                <li>‚úì Within 200m of campus</li>\r\n                <li>‚úì Course selected</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mt-6 bg-white rounded-lg shadow-lg p-6\">\r\n          <h3 className=\"text-lg font-bold text-gray-900 mb-3\">üìç Campus Information</h3>\r\n          <p className=\"text-gray-700 mb-2\">\r\n            <strong>Location:</strong> ICT University Yaound√©, Cameroon\r\n          </p>\r\n          <p className=\"text-gray-700 mb-2\">\r\n            <strong>Coordinates:</strong> 3.8621¬∞N, 11.5021¬∞E\r\n          </p>\r\n          <p className=\"text-gray-700\">\r\n            <strong>Geofence Radius:</strong> 200 meters\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default StudentDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}